/*!
 * Copyright 2011~2013, ICAT JavaScript Library v1.1.6
 * https://github.com/valleykid/icat
 *
 * Copyright (c) 2013 valleykid
 * Licensed under the MIT license.
 *
 * @Author valleykiddy@gmail.com
 * @Time 2013-08-22 20:40:00
 */
;(function(d,g,h){var b=d[h]||{version:"1.1.6"};if(typeof exports!=="undefined"){if(typeof module!=="undefined"&&module.exports){exports=module.exports=b}exports.ICAT=b}else{d[h]=b}b.Shim=d.SHIM||{};f(Array.prototype,{contains:function(i){return this.indexOf(i)>-1},remove:function(j){var i=this;i.forEach(function(k,l){if(k===j){i.splice(l,1)}});return i},unique:function(){var i=this,k={},j=[];i.forEach(function(l){if(!k[l]){j.push(l);k[l]=true}});return j}});c(["String","Boolean","Function","Array","Object","Number"],function(i){b["is"+i]=function(j){return(i==="Array"&&Array.isArray)?Array.isArray(j):Object.prototype.toString.call(j)==="[object "+i+"]"}});c({DebugMode:/debug/i,DemoMode:/localhost|demo\.|\/{2}\d+(\.\d+){3}|file\:/i,IPMode:/\/{2}\d+(\.\d+){3}/},function(j,i){b[i]=j.test(location.href)});f(b,{mix:f,foreach:c,hasItem:function(k,j){if(b.isArray(k)){if("indexOf" in k){return k.indexOf(j)>-1}var i;c(k,function(l){if(l===j){return !(i=true)}});return i}if(b.isObject(k)){return j in k}if(b.isString(k)){return k.indexOf(j)>-1}return false},isjQueryObject:function(i){return !!b.$&&(!!i)&&b.isFunction(i.get)},isEmptyObject:function(j){for(var i in j){return false}return true},render:function(j,n){var i=b.__cache_tmpls||(b.__cache_tmpls={}),l=b.__cache_funs||(b.__cache_funs={}),m;if(b.isEmptyObject(i)){b.foreach(b.app,function(p,o){if(p.template){b.foreach(p.template,function(r,q){i[q]=r.replace(/[\r\t\n]/g,"")})}},undefined,true)}if(/^[\w\-_]+$/.test(j)){if(l[j]){return l[j](n)}else{if(i[j]){m=i[j]}else{var k=UTIL.queryOne("#"+j);m=k?k.innerHTML.replace(/[\r\t\n]/g,"").replace(/\s+(<)|\s*$/g,"$1"):""}i[j]=m;return(l[j]=a(m))(n)}}else{return a(j,n)}},contains:function(j,i){if(b.isArray(j)){return j.contains(i)}if(b.isObject(j)){return i in j}if(b.isString(j)){return j.indexOf(i)>-1}return false},toArray:function(j){var i=[];c(j,function(k){i.push(k)});return i},namespace:function(){var m=arguments,k=m.length,s=null,q,n,r;for(q=0;q<k;++q){r=(""+m[q]).split(".");s=this;for(n=(d[r[0]]===s)?1:0;n<r.length;++n){s=s[r[n]]=s[r[n]]||{}}}return s},app:function(i,l){var j=b.isString(i),k=j?d[i]||{}:i;f(k,b,["namespace"],true);f(k,b.isFunction(l)?l():l);j&&(b.app[i]=d[i]=k);return k},util:function(i,j){if(b.isString(i)){b.util[i]=j}else{if(b.isFunction(i)){f(b.util,i())}else{f(b.util,i)}}},wait:function(i,k,n){k=k||100;n=n||10;var o=b.__cache_timers=b.__cache_timers||{};var j=0,m,l="icat_timer"+Math.floor(Math.random()*1000000+1);(m=function(){i(l,j===k,o);if(j<=k&&o[l]===false){setTimeout(function(){j+=n;m()},n)}})()},ready:function(n){var l=[],k=g.documentElement,o=k.doScroll,m,j=(o?/^loaded|^c/:/^loaded|c/).test(g.readyState),i=function(p){j=1;while(p=l.shift()){p()}};if(g.addEventListener){g.addEventListener("DOMContentLoaded",m=function(){g.removeEventListener("DOMContentLoaded",m,false);i()},false)}if(o){g.attachEvent("onreadystatechange",m=function(){if(/^c/.test(g.readyState)){g.detachEvent("onreadystatechange",m);i()}})}return(n=o?function(p){self!=top?j?p():l.push(p):function(){try{k.doScroll("left")}catch(q){return setTimeout(function(){n(p)},50)}p()}()}:function(p){j?p():l.push(p)})}(),log:function(k){if(!!g.all){d.console&&console.log?console.log(k):alert(k)}else{try{__$abc_ICAT()}catch(j){var i=j.stack.replace(/\n\s+at\s+<.*>/g,"").split("\n")[2];i=i.replace(/.*[\(\s]|\).*/g,"").replace(/(.*):(\d+):\d+/g,"$1  line $2:\n");console.log(i,k)}}}});b.namespace("AMD","OO","SM");function f(t,q,k,o){if(!q||!t){return t}if(o===undefined){o=true}var n,u,j,m=true;if(k&&!b.isArray(k)){k=k.replace(/\s+/g,"").split(",");m=false}if(k&&(j=k.length)){if(m){for(n=0;n<j;n++){u=k[n];if(u in q){if(o||!(u in t)){t[u]=q[u]}}}}else{for(u in q){if(k.indexOf(u)<0&&(o||!(u in t))){t[u]=q[u]}}}}else{for(u in q){if(o||!(u in t)){t[u]=q[u]}}}return t}function c(r,j,m,q){var l,n=0,p=r.length,k=q||p===undefined;if(m){if(k){for(l in r){if(j.apply(r[l],m)===false){break}}}else{for(;n<p;){if(j.apply(r[n++],m)===false){break}}}}else{if(k){for(l in r){if(j.call(r[l],r[l],l)===false){break}}}else{for(;n<p;n++){if(j.call(r[n],r[n],n)===false){break}}}}}function a(i,m){var l=function(){return""},j,k;if(!i){return l}i=i.replace(/[\r\t\n]/g,"");j="var __p_fun = [], _self = jsonData; with(jsonData){__p_fun.push('"+i.replace(/<%=(.*?)%>/g,"',(typeof $1!='undefined'? $1:''),'").replace(/<%(.*?)%>/g,"');$1__p_fun.push('")+"');};return __p_fun.join('');";k=new Function("jsonData",j);return m?k(m):k}var e=b.$$=function(){return new e.fn.init()};e.fn=e.prototype={init:function(i){if(b.isString(i)){}return this},extend:function(j){var i=this;if(b.isObject(j)){c(j,function(m,l){if(b.isFunction(m)){i[l]=function(){return m.call(i)||i}}else{i[l]=m}})}return i}};e.fn.init.prototype=e.fn})(this,document,"ICAT");(function(l,m,g){g.ModConfig=function(o){g.mix(g.ModConfig,o)};(g.PathConfig=function(p){var r=g.PathConfig;if(!r._hasReady){var o=m.getElementsByTagName("script"),s=o[o.length-1],u=s.hasAttribute?s.src:s.getAttribute("src",4),v=s.baseURI||m.baseURI||m.URL,q=s.getAttribute("data-main"),t=s.getAttribute("data-cssfile");r.weinreRef=g.IPMode?v.replace(/(^\w+:\/{2,}[^\/]+).*/g,"$1:8080/"):"";r.timestamp=g.hasItem(u,"?")?u.replace(/[^?]+\?/g,"?"):"";r.staticRef=u.replace(/(^\w+:\/{2,}[^\/]+).*/g,"$1");r.sysRef=u.replace(/^\w+:\/{2,}[^\/]+|[^\/]+$/g,"");if(q){q=f(q,r.sysRef)[0];r.appRef=q.replace(/[^\/]+$/g,"");t=t?f(t)[0]:"../css/main.css";r.mainScript=[t,q]}else{r.appRef=r.sysRef}r.LoadedGroup={};r.ModGroup={};r._hasReady=true}if(p){g.mix(r,p)}})();g.mix(g,{inc:function(o){if(!o){return}o=f(o);g.foreach(h(o),function(p){if(!p){return}i(p)})},include:function(){if(!arguments.length){return}arguments.length==1?b(arguments[0]):b({files:arguments[0],callback:arguments[1],isDepend:arguments[2],isCombo:arguments[3]})},require:function(){if(!arguments.length){return}arguments.length==1?b(arguments[0],true):b({modName:arguments[0],files:arguments[1],callback:arguments[2],isCombo:arguments[3]},true)},use:function(){if(!arguments.length){return}arguments.length==1?j(arguments[0]):j({modName:arguments[0],callback:arguments[1],delay:arguments[2]||500,step:arguments[3]})}});g.ModConfig({"$MVC":"./mvc","$Event":"./event","$Dom":"./dom","$util":"./util",appmvc:["$MVC","./mvc/view.js","./mvc/model.js","./mvc/controller.js"],"$Zepto":"../../lib/zepto/zepto","$jQuery":"../../lib/jquery/jquery"});g.weinreStart=function(){var p=g.PathConfig,o;if(!p.weinreRef){return}o=p.weinreRef+"/target/target-script-min.js#anonymous!";g.include(o)};if(!/MSIE\s?[6-8]/.test(navigator.userAgent)&&g.IPMode){g.weinreStart()}g.include({files:g.PathConfig.mainScript,domReady:false});function j(o){if(!o||!g.isObject(o)){return}g.wait(function(p,q,r){if(!g.PathConfig.ModGroup[o.modName]){r[p]=false;if(q&&g.ModConfig[o.modName]){delete r[p];b({modName:o.modName,files:g.ModConfig[o.modName],callback:o.callback},true)}return}delete r[p];if(o.callback){o.callback.call(g,l[o.modName])}},o.delay,o.step)}function b(p,q,o){if(!p){return}if(q){if(g.isString(p)){p={modName:p}}if(!g.isObject(p)||!(p.files=p.files||g.ModConfig[p.modName])){return}if(!g.ModConfig[p.modName]){g.ModConfig[p.modName]=p.files}}else{if(g.isString(p)||g.isArray(p)){p={files:p}}if(!g.isObject(p)||!p.files){return}}p.argus=[];g.foreach(g.isArray(p.files)?p.files:[p.files],function(r){if(/^\$?\w+$/.test(r)){p.argus.push(r)}});p.files=h(f(p.files),p.isCombo);if(q){p.isDepend=true}if(p.domReady===undefined){p.domReady=true}(o=function(){if(!p.files.length){return}var r=p.files.shift();if(p.files.length){if(p.isDepend){c({file:r,modName:p.modName,callback:function(){if(!g.$&&l.$){g.$=l.jQuery||l.Zepto||l.ender||l.$}o()}})}else{c({file:r,callback:function(){if(!g.$&&l.$){g.$=l.jQuery||l.Zepto||l.ender||l.$}}});o()}}else{c({file:r,callback:function(t,s){t=g.PathConfig.ModGroup;s=[];g.foreach(p.argus,function(v){var u=v.charAt(0)==="$"?v.slice(1):v,w=l[u]||g[u];if(w){s.push(w)}});if(p.domReady===false){if(!g.$&&l.$){g.$=l.jQuery||l.Zepto||l.ender||l.$}if(p.callback){p.callback.apply(g,s)}if(p.modName){t[p.modName]=true}}else{g.ready(function(){if(!g.$&&l.$){g.$=l.jQuery||l.Zepto||l.ender||l.$}if(p.callback){p.callback.apply(g,s)}if(p.modName){t[p.modName]=true}})}}})}})()}function c(q){var p=d(q.file),r,s=q.file.replace(/(\?|#).*$/,""),o=g.PathConfig.LoadedGroup;if(o[s]){if(q.callback){q.callback()}return}r=s.match(/[^\.]+$/)[0];/css/i.test(r)?e(q):a(q)}function i(p){var o=d(p),r=p.replace(/(\?|#).*$/,""),q=g.PathConfig.LoadedGroup;if(q[r]){return}var t=r.match(/[^\.]+$/)[0],u=/css/i.test(t),w=u?"link":"script",s=u?' type="text/css" rel="stylesheet"':' type="text/javascript"',v=(u?"href":"src")+'="'+o+'"';m.write("<"+w+s+v+(u?"/>":"></"+w+">"));q[r]=true;if(!g.$&&l.$){g.$=l.jQuery||l.Zepto||l.ender||l.$}}function h(o,u){var t=g.PathConfig,r=[];if(u){var q=[],p=[],s=[];g.foreach(o,function(w){/^\w+/.test(w)?s.push(w):/\.css/i.test(w)?q.push(w):p.push(w)});if(q.length){q=t.staticRef+(q.length===1?q[0]:"/??"+q.join(","));r.push(q)}if(p.length){p=t.staticRef+(p.length===1?p[0]:"/??"+p.join(","));r.push(p)}if(s.length){r=r.concat(s)}}else{g.foreach(o,function(w){r.push((/^\w+/.test(w)?"":t.staticRef)+w)})}return r}function f(q,r){var p=[];if(g.isArray(q)){g.foreach(q,function(t){var s=n(t,r);g.foreach(s,function(u){p.push(k(u))})})}else{var o=n(q,r);g.foreach(o,function(s){p.push(k(s))})}return p}function n(t,u){var w=g.ModConfig,r=g.PathConfig,q=t.charAt(0),p=q==="$"?t:"$"+t,o=[],v;if(/^\$?\w+$/.test(t)){if(w[p]){v=w[p];u=u||r.sysRef}else{if(w[t]){v=w[t];u=u||r.appRef}}if(v){if(g.isArray(v)){g.foreach(v,function(s){if(s){o.push([s,u])}})}else{o.push([v,u])}}else{o.push([t+".js"])}}else{if(q==="."){o.push([t,u||r.appRef])}else{if(q==="~"){o.push([r.staticRef+"/"+t.slice(1)])}else{if(t){o.push([t])}}}}return o}function k(r){var t=r[0],q=r[1]||"",u=/!$/.test(t),p=t.charAt(1);t=t.replace(/\s+|[!\?].*$/g,"").replace(/(\w+)(\/?\.{2,})+/g,"$1").replace(/(\/[^\.]+)$/,"$1.js");if(p==="/"){t=t.replace(/^\.\//,q)}else{if(p==="."){if(!q){t=t.replace(/(\.{2}\/)+/,q)}else{var s=t.match(/\.{2}\//g),o;if(s!=null){o=q.replace(/\/$/,"").split("/");g.foreach(s,function(){if(o.length){o.pop()}else{return false}});if(o.length){o.push("");o=o.join("/")}else{o="/"}t=t.replace(/(\.{2}\/)+/,o)}}}}if(g.DebugMode){t=u||/\.source\./i.test(t)?t:t.replace(/([^.]+)$/,"source.$1")}return t}function d(p){var o=g.PathConfig;if(o.timestamp){p=p.replace(/\?([^\?\/]+)$/,"&$1")}return/#|&/.test(p)?p.replace(/(#|&)/,o.timestamp+"$1"):p+o.timestamp}function e(r,q){var p=d(r.file),s=m.createElement("link"),q=r.pNode||m.head||m.getElementsByTagName("head")[0],o=g.PathConfig.LoadedGroup;s.setAttribute("type","text/css");s.setAttribute("rel","stylesheet");s.setAttribute("href",p);setTimeout(function(){if(r.callback){r.callback()}o[r.file]=true},15);q.appendChild(s)}function a(r,q){var p=d(r.file),s,t=m.createElement("script"),q=r.pNode||m.head||m.getElementsByTagName("head")[0],o=g.PathConfig.LoadedGroup;t.setAttribute("type","text/javascript");t.setAttribute("src",p);t.setAttribute("async",true);if("onload" in t){t.addEventListener("load",s=function(){t.removeEventListener("load",s,false);if(r.callback){r.callback()}o[r.file]=true},false)}else{if(t.readyState){t.attachEvent("onreadystatechange",s=function(){if(/loaded|complete/i.test(t.readyState)){t.detachEvent("onreadystatechange",s);if(r.callback){r.callback()}o[r.file]=true}})}}q.appendChild(t)}})(this,document,ICAT);