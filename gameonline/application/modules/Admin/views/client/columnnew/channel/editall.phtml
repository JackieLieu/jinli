<?php echo $this->render("layout/header.phtml");?>
<style>
	.coloum{
		width:200px;
		text-align: center;
	}
	.inner_table tr td{
		padding: 7px 10px 9px;
	}
	.inner_table tr td:hover{
		background: none!important;
	}
	.handpick_mask{
		display: none;
	}
</style>
<div class="nav">
	<ul class="cc">
        <li ><a href="<?php echo $listUrl;?>">栏目管理</a></li>
		<li><a href="<?php echo $listChannelUrl;?>">频道管理</a></li>
    	<li class="current"><a href="javascript:;">编辑频道位置</a></li>
	</ul>
</div>
<div class="h_a">编辑频道位置 		
<span class="btn2"><span><a href="<?php echo $infoUrl;?>" style="text-decoration:none;color:#ffffff;">频道位置说明</a></span></span></div>
<form method="post" action="<?php echo $editChanneAllPostUrl;?>" id="addFrom">
<input name="token" value="<?php echo $token;?>" type="hidden" />
<div class="table_full">
		<table  width="100%">
		<?php foreach ($parentinfo as $value){?>
			<tr class="tr">
				<td class="coloum" ><?php echo $value['id'].'-'.$value['name']; ?></td>
				<td>
					<table class="inner_table">
						<tr >
							<td>
								<span><?php echo $value['id']; ?>-1</span>
								<select name="name<?php echo $value['id']; ?>1" class="select wa">
									<option  value="" >空</option>
								    <?php 
							        foreach ($info as $val) {
							      	?>		
									<option  value="<?php echo $val['name'].'-'.$val['id'].'-'.$val['relevance'].'-'.$val['channel_type'].'-'.'2' ;?>"  <?php echo ($positon_arr[$value['id'].'-1'] == $val['name'])? 'SELECTED':'' ?> <?php if($val['relevance'] == 'chosen') echo 'data-handpick=1';  ?> ><?php echo $val['name'].(($val['channel_type'] ==1 )?'(默认)':'(扩展)')  ;?></option>			
								   <?php }?>	
								</select>
							</td>
						</tr>
						<tr >
							<td>
							<span><?php echo $value['id']; ?>-2</span>
								<select name="name<?php echo $value['id']; ?>2" class="select wa">
								  <option  value="" >空</option>
							      <?php 
							        foreach ($info as $val) {
							      	?>	
									<option  value="<?php echo $val['name'].'-'.$val['id'].'-'.$val['relevance'].'-'.$val['channel_type'].'-'.'2' ;?>"  <?php echo ($positon_arr[$value['id'].'-2'] == $val['name'])? 'SELECTED':'' ?> <?php if($val['relevance'] == 'chosen') echo 'data-handpick=1';  ?> ><?php echo $val['name'].(($val['channel_type'] ==1 )?'(默认)':'(扩展)');?></option>			
								   <?php }?>	
								</select>
							</td>
						</tr>
						<tr >
							<td>
							<span><?php echo $value['id']; ?>-3</span>
								<select name="name<?php echo $value['id']; ?>3" class="select wa">
								<option  value="" >空</option>
								   <?php 
							        foreach ($info as $val) {
							      	?>	
									<option  value="<?php echo $val['name'].'-'.$val['id'].'-'.$val['relevance'].'-'.$val['channel_type'].'-'.'2' ;?>" <?php echo ($positon_arr[$value['id'].'-3'] == $val['name'])? 'SELECTED':'' ?> <?php if($val['relevance'] == 'chosen') echo 'data-handpick=1';  ?> ><?php echo $val['name'].(($val['channel_type'] ==1 )?'(默认)':'(扩展)');?></option>			
								   <?php }?>	

								</select>
							</td>
						</tr>
						<tr >
							<td>
							<span><?php echo $value['id']; ?>-4</span>
								<select name="name<?php echo $value['id']; ?>4" class="select wa">
								<option  value="" >空</option>
								   <?php  
							        foreach ($info as $val) {
							      	?>
									<option  value="<?php echo $val['name'].'-'.$val['id'].'-'.$val['relevance'].'-'.$val['channel_type'].'-'.'2' ;?>"  <?php echo ($positon_arr[$value['id'].'-4'] == $val['name'])? 'SELECTED':'' ?> <?php if($val['relevance'] == 'chosen') echo 'data-handpick=1';  ?> ><?php echo $val['name'].(($val['channel_type'] ==1 )?'(默认)':'(扩展)');?></option>			
								   <?php }?>	
								</select>
							</td>
						</tr>
					</table>	
				</td>
			</tr>
			<?php }?>		
		</table>
</div>
<div class="mb10 tac"><span class="btn"><span><button onfocus="blur();" type="submit">提交</button></span></span></div>
</form>
<div class="handpick_mask">
	<table  id="insert_table" class="">
		<tr >
			<td>
			    <span>6-1</span>
				<select name="name61" class="select wa">
				<option  value="" >空</option>
				 <?php 
			        foreach ($info as $val) {
						if($val['relevance'] == 'chosen'){
							continue;
						}
			      	?>
					<option  value="<?php echo $val['name'].'-'.$val['id'].'-'.$val['relevance'].'-'.$val['channel_type'].'-'.'3' ;?>"  <?php echo ($positon_arr['6-1'] == $val['name'])? 'SELECTED':'' ?> <?php if($val['relevance'] == 'chosen') echo 'data-handpick=1';  ?> ><?php echo $val['name'].(($val['channel_type'] ==1 )?'(默认)':'(扩展)');?></option>			
				   <?php }?>	
				</select>
			</td>
		</tr>
		<tr >
				<td>
			    <span>6-2</span>
				<select name="name62" class="select wa">
				<option  value="" >空</option>
				 <?php 
			        foreach ($info as $val) {
                        if($val['relevance'] == 'chosen'){
                        	continue;
                        }
			      	?>
					<option  value="<?php echo $val['name'].'-'.$val['id'].'-'.$val['relevance'].'-'.$val['channel_type'].'-'.'3' ;?>"  <?php echo ($positon_arr['6-2'] == $val['name'])? 'SELECTED':'' ?> <?php if($val['relevance'] == 'chosen') echo 'data-handpick=1';  ?> ><?php echo $val['name'].(($val['channel_type'] ==1 )?'(默认)':'(扩展)');?></option>			
				   <?php }?>	
				</select>
			</td>
		</tr>
		<tr >
				<td>
			    <span>6-3</span>
				<select name="name63" class="select wa">
				<option  value="" >空</option>
				 <?php 
			        foreach ($info as $val) {
						if($val['relevance'] == 'chosen'){
							continue;
						}
			      	?>
					<option  value="<?php echo $val['name'].'-'.$val['id'].'-'.$val['relevance'].'-'.$val['channel_type'].'-'.'3' ;?>"  <?php echo ($positon_arr['6-3'] == $val['name'])? 'SELECTED':'' ?> <?php if($val['relevance'] == 'chosen') echo 'data-handpick=1';  ?> ><?php echo $val['name'].(($val['channel_type'] ==1 )?'(默认)':'(扩展)');?></option>			
				   <?php }?>	
				</select>
			</td>
		</tr>
		<tr >
			<td>
			    <span>6-4</span>
				<select name="name64" class="select wa">
				<option  value="" >空</option>
				 <?php 
			        foreach ($info as $val) {
					if($val['relevance'] == 'chosen'){
						continue;
					}
			      	?>
					<option  value="<?php echo $val['name'].'-'.$val['id'].'-'.$val['relevance'].'-'.$val['channel_type'].'-'.'3' ;?>"  <?php echo ($positon_arr['6-4'] == $val['name'])? 'SELECTED':'' ?> <?php if($val['relevance'] == 'chosen') echo 'data-handpick=1';  ?> ><?php echo $val['name'].(($val['channel_type'] ==1 )?'(默认)':'(扩展)');?></option>			
				   <?php }?>	
				</select>
			</td>
		</tr>
	</table>
</div>
<script type="text/javascript">
$(document).ready(function(){
	ajaxForm('addFrom',function(ret){
		ajaxRedirect1(ret, baseurl+'/Admin/Client_Columnnew/channel_index');
	});

	$(".table_full").find("select").each(function(){
		linkage($(this));
		$(this).change(function(){
			linkage($(this));
		})
	})	
	// ajax跳转
function ajaxRedirect1(ret, url) {
	if (ret == '')
		return false;
	if (ret) {
		if (ret.success) {
			showMsg('', ret.msg);
			setTimeout(function() {
						location.href = url;
					}, 3000);
		} else {
			showError('', ret.msg);
		}
	}
}
})
function linkage(select){
	var that=select,
		html=$("#insert_table").html();
	if(that.find("option:selected").attr('data-handpick')==1){
		
		that.parent('td').parent('tr').append(html);
		// $("#insert_table").show();
	} else{
			if(that.parent('td').parent('tr').find("tbody").length>0){
				
				that.parent('td').parent('tr').find("tbody").remove();
			}
		
		
	}
}
</script>
<?php echo $this->render("layout/footer.phtml");?>