(function(d){var e=null,c,b=true,a={tit:"\u63d0\u793a\u4fe1\u606f",w:"\u8bf7\u8f93\u5165\u6b63\u786e\u4fe1\u606f\uff01",r:"\u901a\u8fc7\u4fe1\u606f\u9a8c\u8bc1\uff01",c:"\u6b63\u5728\u68c0\u6d4b\u4fe1\u606f\u2026",s:"\u8bf7\u586b\u5165\u4fe1\u606f\uff01",v:"\u6240\u586b\u4fe1\u606f\u6ca1\u6709\u7ecf\u8fc7\u9a8c\u8bc1\uff0c\u8bf7\u7a0d\u540e\u2026",p:"\u6b63\u5728\u63d0\u4ea4\u6570\u636e\u2026",err:"\u51fa\u9519\u4e86\uff01\u8bf7\u68c0\u67e5\u63d0\u4ea4\u5730\u5740\u6216\u8fd4\u56de\u6570\u636e\u683c\u5f0f\u662f\u5426\u6b63\u786e\uff01",security:"\u5b89\u5168\u9519\u8bef\uff0c\u60a8\u4e0d\u80fd\u63d0\u4ea4\u8868\u5355\uff01"},f=function(){if(d("#Validform_msg").length!==0){return false}c=d('<div id="Validform_msg"><div class="Validform_title">'+a.tit+'<a class="Validform_close" href="javascript:void(0);">&chi;</a></div><div class="Validform_info"></div><div class="iframe"><iframe frameborder="0" scrolling="no" height="100%" width="100%"></iframe></div></div>').appendTo("body");c.find("a.Validform_close").click(function(){c.hide();b=true;if(e){e.focus().addClass("Validform_error")}return false}).focus(function(){this.blur()});d(window).bind("scroll resize",function(){if(!b){var i=(d(window).width()-c.outerWidth())/2,h=(d(window).height()-c.outerHeight())/2,g=(document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop)+(h>0?h:0);c.animate({left:i,top:g},{duration:400,queue:false})}})};d.Tipmsg=a;d.fn.Validform=function(g){var h={};g=d.extend({},d.fn.Validform.sn.defaults,g);g.datatype&&d.extend(d.Datatype,g.datatype);if(d("input[type=password][tip]")[0]){d(document).bind("click",function(){var l=d("input[type=password][tip]"),j=l.attr("tip"),k=l.siblings("s");l.val()==j?k.show():k.hide()});var i=setInterval(function(){d(document).trigger("click")},1)}this.each(function(l){var p=d(this),o=p.find("[datatype]").length,k=false;p.find("[tip]").each(function(){var t=d(this).attr("tip"),s=d(this).attr("altercss"),r=d(this).attr("type")==="password";d(this).focus(function(){if(d(this).val()==t){if(r){d(this).siblings("s").hide()}d(this).val("");if(s){d(this).removeClass(s)}}}).blur(function(){if(d.trim(d(this).val())===""){if(r){d(this).siblings("s").show()}d(this).val(t);if(s){d(this).addClass(s)}}})});p.find("input[recheck]").each(function(){var s=d(this);var r=p.find("input[name='"+d(this).attr("recheck")+"']");r.bind("keyup",function(){if(r.val()==s.val()&&r.val()!=""){if(r.attr("tip")){if(r.attr("tip")==r.val()){return false}}s.trigger("blur")}}).bind("blur",function(){if(r.val()!=s.val()&&s.val()!=""){if(s.attr("tip")){if(s.attr("tip")==s.val()){return false}}s.trigger("blur")}})});if(g.usePlugin){if(g.usePlugin.swfupload){var m=p.find("input[plugin='swfupload']").val(""),n={custom_settings:{form:p,showmsg:function(s,r){d.fn.Validform.sn.showmsg(s,g.tiptype,{obj:m,type:r})}}};n=d.extend(true,{},g.usePlugin.swfupload,n);if(typeof(swfuploadhandler)!="undefined"){swfuploadhandler.init(n,l)}}if(g.usePlugin.datepicker){if(g.usePlugin.datepicker.format){Date.format=g.usePlugin.datepicker.format;delete g.usePlugin.datepicker.format}if(g.usePlugin.datepicker.firstDayOfWeek){Date.firstDayOfWeek=g.usePlugin.datepicker.firstDayOfWeek;delete g.usePlugin.datepicker.firstDayOfWeek}var q=p.find("input[plugin='datepicker']");g.usePlugin.datepicker.callback&&q.bind("dateSelected",function(){var r=new Date(d.event._dpCache[this._dpId].getSelected()[0]).asString(Date.format);g.usePlugin.datepicker.callback(r,this)});q.datePicker(g.usePlugin.datepicker)}if(g.usePlugin.passwordstrength){g.usePlugin.passwordstrength.showmsg=function(s,t,r){d.fn.Validform.sn.showmsg(t,g.tiptype,{obj:s,type:r,sweep:g.tipSweep},"hide")};p.find("input[plugin*='passwordStrength']").passwordStrength(g.usePlugin.passwordstrength)}}p.find("[datatype]").bind(g.etype?g.etype:"blur",function(){var t=true;t=d.fn.Validform.sn.checkform(d(this),p,{type:g.tiptype,sweep:g.tipSweep},"hide");if(!t){return false}if(typeof(t)!="boolean"){d(this).removeClass("Validform_error");return false}var s=d(this).attr("datatype");if(/,/.test(s)){s=s.split(",");t=d.fn.Validform.sn.regcheck(s[0],d(this).val(),d(this))&&d.fn.Validform.sn.regcheck(s[1],d(this).val(),d(this));var v=!d.fn.Validform.sn.regcheck(s[0],d(this).val(),d(this))?0:1}else{t=d.fn.Validform.sn.regcheck(s,d(this).val(),d(this))}if(!t){if(d(this).attr("ignore")==="ignore"&&(d(this).val()===""||d(this).val()===d(this).attr("tip"))){if(g.tiptype==2){var u=d(this).siblings(".Validform_checktip");if(u.is(".Validform_right")){u.text(d(this).attr("errormsg"))}u.removeClass().addClass("Validform_checktip")}else{if(typeof g.tiptype=="function"){(g.tiptype)("",{obj:d(this),type:4},d.fn.Validform.sn.cssctl)}}t=true;e=null;return true}var x=v?d(this).attr("errormsg").split("|")[v]:d(this).attr("errormsg");d.fn.Validform.sn.showmsg(x||a.w,g.tiptype,{obj:d(this),type:3,sweep:g.tipSweep},"hide")}else{if(d(this).attr("ajaxurl")){var w=d(this);var r=arguments[1];if(w.attr("valid")=="posting"){return false}w.attr("valid","posting");d.fn.Validform.sn.showmsg(a.c,g.tiptype,{obj:w,type:1,sweep:g.tipSweep},"hide");d.ajax({type:"POST",url:w.attr("ajaxurl")+(/\?/.test(w.attr("ajaxurl"))?"&t=":"?t=")+(new Date()).getTime(),data:d(this).attr("allForm")&&d(this).attr("allForm")=="true"?d(this).parents("form").serialize():d(this).attr("name")+"="+d(this).val(),dataType:"text",success:function(y){if(d.trim(y)=="y"){w.attr("valid","true");d.fn.Validform.sn.showmsg(a.r,g.tiptype,{obj:w,type:2,sweep:g.tipSweep},"hide");if(r==="postform"){p.trigger("submit")}}else{w.attr("valid",y);d.fn.Validform.sn.showmsg(y,g.tiptype,{obj:w,type:3,sweep:g.tipSweep})}},error:function(){w.attr("valid",a.err);d.fn.Validform.sn.showmsg(a.err,g.tiptype,{obj:w,type:3,sweep:g.tipSweep})}})}else{d.fn.Validform.sn.showmsg(a.r,g.tiptype,{obj:d(this),type:2,sweep:g.tipSweep},"hide")}}});p.find(":checkbox[datatype],:radio[datatype]").each(function(){var s=d(this);var r=s.attr("name");p.find("[name='"+r+"']").filter(":checkbox,:radio").bind("click",function(){s.trigger("blur")})});var j=function(){if(o!=p.find("[datatype]").length){d.Showmsg(a.security);return false}var r=true,s=true;if(k){return false}p.find("[datatype]").each(function(){s=d.fn.Validform.sn.checkform(d(this),p,{type:g.tiptype,sweep:g.tipSweep});if(!s){if(!g.showAllError){e.focus();r=false;return false}r&&(r=false);return true}if(typeof(s)!="boolean"){return true}s=d.fn.Validform.sn.regcheck(d(this).attr("datatype"),d(this).val(),d(this));if(s&&d(this).is("[datatype*='option_']")){d(this).trigger("blur")}if(!s){if(d(this).attr("ignore")==="ignore"&&(d(this).val()===""||d(this).val()===d(this).attr("tip"))){e=null;return true}d.fn.Validform.sn.showmsg(d(this).attr("errormsg")||a.w,g.tiptype,{obj:d(this),type:3,sweep:g.tipSweep});if(!g.showAllError){e.focus();r=false;return false}r&&(r=false);return true}if(d(this).attr("ajaxurl")){if(d(this).attr("valid")!="true"){var t=d(this);d.fn.Validform.sn.showmsg(a.v,g.tiptype,{obj:t,type:3,sweep:g.tipSweep});if(!b||g.tiptype!=1){setTimeout(function(){t.trigger(g.etype?g.etype:"blur",["postform"])},1500)}if(!g.showAllError){r=false;return false}r&&(r=false);return true}else{d.fn.Validform.sn.showmsg(a.r,g.tiptype,{obj:d(this),type:2,sweep:g.tipSweep},"hide")}}});if(g.showAllError){p.find(".Validform_error:first").focus()}if(r&&!k){e=null;if(g.postonce){k=true}if(g.ajaxPost){d.fn.Validform.sn.showmsg(a.p,g.tiptype,{obj:p,type:1,sweep:g.tipSweep},"alwaysshow");d.ajax({type:"POST",dataType:"json",url:p.attr("action")+"?t="+(new Date()).getTime(),data:decodeURIComponent(p.serialize(),true),success:function(t){if(t.status==="y"){d.fn.Validform.sn.showmsg(t.info,g.tiptype,{obj:p,type:2,sweep:g.tipSweep},"alwaysshow")}else{k=false;d.fn.Validform.sn.showmsg(t.info,g.tiptype,{obj:p,type:3,sweep:g.tipSweep},"alwaysshow")}g.callback&&g.callback(t)},error:function(){k=false;d.fn.Validform.sn.showmsg(a.err,g.tiptype,{obj:p,type:3,sweep:g.tipSweep},"alwaysshow")}});return false}else{g.callback?g.callback(p):p.get(0).submit()}}};g.btnSubmit&&p.find(g.btnSubmit).bind("click",j);p.submit(function(){j();return false});p.find("input[type='reset']").click(function(){p.find(".Validform_right").text("");p.find(".Validform_checktip").removeClass("Validform_wrong Validform_right Validform_loading");p.find(".Validform_error").removeClass("Validform_error");p.find("input:first").focus()})});if(g.tiptype==1||(g.tiptype==2&&g.ajaxPost)){f()}};d.fn.Validform.sn={defaults:{tiptype:1,tipSweep:false,showAllError:false,postonce:false,ajaxPost:false},toString:Object.prototype.toString,regcheck:function(i,l,k){if(this.toString.call(d.Datatype[i])=="[object Function]"){return(d.Datatype[i])(l,k)}if(!(i in d.Datatype)){var n=i.match(d.Datatype.match),g;reg:for(var h in d.Datatype){g=h.match(d.Datatype.match);if(!g){continue reg}if(n[1]===g[1]){var m=d.Datatype[h].toString();var j=new RegExp("\\{"+g[2]+","+g[3]+"\\}");m=m.replace(j,"{"+n[2]+","+n[3]+"}").replace(/^\//,"").replace(/\/$/,"");d.Datatype[i]=new RegExp(m);break reg}}}if(this.toString.call(d.Datatype[i])=="[object RegExp]"){return d.Datatype[i].test(l)}return false},showmsg:function(l,h,k,g){if(k.type==3&&!k.obj.is("form")){e=k.obj}else{e&&e.removeClass("Validform_error");e=null}e&&e.addClass("Validform_error");if(typeof h=="function"){if(!(k.sweep&&g=="hide")){h(l,k,this.cssctl)}return false}if(h==1||g=="alwaysshow"){c.find(".Validform_info").text(l)}if(h==1&&g!="hide"||g=="alwaysshow"){b=false;c.find(".iframe").css("height",c.outerHeight());var j=(d(window).width()-c.outerWidth())/2;var i=(d(window).height()-c.outerHeight())/2;i=(document.documentElement.scrollTop?document.documentElement.scrollTop:document.body.scrollTop)+(i>0?i:0);c.css({left:j}).show().animate({top:i},100)}if(h==2&&k.obj){k.obj.siblings(".Validform_checktip").text(l);this.cssctl(k.obj.siblings(".Validform_checktip"),k.type)}},checkform:function(k,j,g,o){var l=k.attr("errormsg")||a.w,i;if(k.is("[datatype='radio']")){i=k.attr("name");var n=j.find(":radio[name='"+i+"']:checked").val();if(!n){this.showmsg(l,g.type,{obj:k,type:3,sweep:g.sweep},o);return false}this.showmsg(a.r,g.type,{obj:k,type:2,sweep:g.sweep},"hide");return"radio"}if(k.is("[datatype='checkbox']")){i=k.attr("name");var m=j.find(":checkbox[name='"+i+"']:checked").val();if(!m){this.showmsg(l,g.type,{obj:k,type:3,sweep:g.sweep},o);return false}this.showmsg(a.r,g.type,{obj:k,type:2,sweep:g.sweep},"hide");return"checkbox"}if(k.is("[datatype='select']")){if(!k.val()){this.showmsg(l,g.type,{obj:k,type:3,sweep:g.sweep},o);return false}this.showmsg(a.r,g.type,{obj:k,type:2,sweep:g.sweep},"hide");return"select"}if(k.is("[datatype*='option_']")){k.removeClass("Validform_error");e=null;return true}var p=k.attr("tip");if((d.trim(k.val())===""||k.val()===p)&&k.attr("ignore")!="ignore"){this.showmsg(k.attr("nullmsg")||a.s,g.type,{obj:k,type:3,sweep:g.sweep},o);return false}if(k.attr("recheck")){var h=j.find("input[name='"+k.attr("recheck")+"']:first");if(k.val()!=h.val()){this.showmsg(l,g.type,{obj:k,type:3,sweep:g.sweep},o);return false}this.showmsg(a.r,g.type,{obj:k,type:2,sweep:g.sweep},"hide")}k.removeClass("Validform_error");e=null;return true},cssctl:function(h,g){switch(g){case 1:h.removeClass("Validform_right Validform_wrong").addClass("Validform_checktip Validform_loading");break;case 2:h.removeClass("Validform_wrong Validform_loading").addClass("Validform_checktip Validform_right");break;case 4:h.removeClass("Validform_right Validform_wrong Validform_loading").addClass("Validform_checktip");break;default:h.removeClass("Validform_right Validform_loading").addClass("Validform_checktip Validform_wrong")}}};d.Showmsg=function(g){f();d.fn.Validform.sn.showmsg(g,1,{})};d.Hidemsg=function(){c.hide();b=true};d.Datatype={match:/^(.+)(\d+)-(\d+)$/,"*":/.+/,"*6-16":/^.{6,16}$/,n:/^\d+$/,"n6-16":/^\d{6,16}$/,s:/^[\u4E00-\u9FA5\uf900-\ufa2d\w\.\s]+$/m,"s6-18":/^[\u4E00-\u9FA5\uf900-\ufa2d\w\.\s]{6,18}$/,p:/^[+]{0,1}(\d){1,4}[ ]{0,1}([-]{0,1}((\d)|[ ]){1,12})+$/,m:/^((\+86)|86|0)?(13\d|15[012356789]|18[0236789]|14[57])\d{8}$/,e:/^\w+([-+.']\w+)*@\w+([-.]\w+)*\.\w+([-.]\w+)*$/,url:/^(\w+:\/\/)?\w+(\.\w+)+$/}})(jQuery);
