/*
 * Copyright 2011, ICAT JavaScript Library v1.0.1
 * MIT Licensed
 * @Author jn_dream@163.com
 * @Time 2012-01-05 13:52:30
 */
(function(b,c){if(c[b]===undefined){c[b]={}}b=c[b];var e=document.getElementById("J_hostPath"),g=Array.prototype,d=g.indexOf,a=Object.prototype.toString,h=function(l,n){for(var m=0,k=l.length;m<k;++m){if(l[m]===n){return m}}return -1},j=function(n,m,q,l){if(!m||!n){return n}if(l===undefined){l=true}if(q&&(len=q.length)){if(typeof q==="string"&&/(\^)/g.test(q)){var q=q.replace(/(\^)/g,"").split("|");for(var o in m){if(h(q,o)<0){if(l||!(o in n)){n[o]=m[o]}}}}else{for(var k=0;k<len;k++){o=q[k];if(o in m){if(l||!(o in n)){n[o]=m[o]}}}}}else{for(var o in m){if(l||!(o in n)){n[o]=m[o]}}}return n},f={};j(b,{version:"1.0.1",__SYS_PATH:e.getAttribute("sys-hostPath"),__APP_PATH:e.getAttribute("app-filePath"),__APP_MEMBERS:["namespace"],__APP_INIT_METHODS:["__init"],__init:function(){this.Mods={}},isNull:function(k){return k===null},isUndefined:function(k){return k===undefined},isBoolean:function(k){return typeof k==="boolean"},isString:function(k){return typeof k==="string"},isNumber:function(k){return typeof k==="number"&&isFinite(k)},isFunction:function(k){return k.constructor===Function},isArray:function(k){return k.constructor===Array},inArray:h,indexOf:d?function(l,k){return d.call(k,l)}:function(n,l){for(var m=0,k=l.length;m<k;++m){if(l[m]===n){return m}}return -1},foreach:function(l,k){for(var n=0,m=l.length;n<m;n++){k.call(l[n])}},mix:function(){var p=arguments,r=this;if(p.length==1){return j(r,p[0])}if(this.isArray(p[1])){var t={},l=p[1],n=0,k=l.length,o=[],m=0,q=p.length;for(;n<k;n++){j(t,l[n],undefined,true)}for(;m<q;m++){m===1?o.push(t):o.push(p[m])}return j.apply(r,o)}else{return j.apply(r,p)}},add:function(l,m){var k=this;k.Mods[l]={name:l,func:m};m(k)},namespace:function(){var m=arguments,k=m.length,s=null,q,n,r;for(q=0;q<k;++q){r=(""+m[q]).split(".");s=this;for(n=(c[r[0]]===s)?1:0;n<r.length;++n){s=s[r[n]]=s[r[n]]||{}}}return s},app:function(m,q){var l=this,o=b.isString(m),p=o?c[m]||{}:m,n=0,k=l.__APP_INIT_METHODS.length;j(p,l,true,l.__APP_MEMBERS);for(;n<k;n++){l[l.__APP_INIT_METHODS[n]].call(p)}j(p,b.isFunction(q)?q():q);o&&(c[m]=p);return p},log:function(m,k,l){var n=this.Config;if(n.debug){l&&(m=l+": "+m);if(c.console!==undefined&&console.log){console[k&&console[k]?k:"log"](m)}}},error:function(k){if(this.Config.debug){throw k}}});b.__init()})("ICAT",this);(function(c){var k={sysPlugin:c.__SYS_PATH+"/sys/icat/"+c.version+"/plugin/",appPic:c.__APP_PATH+"/pic/",appPlugin:c.__APP_PATH+"/assets/plugin/",appImg:c.__APP_PATH+"/assets/img/",appCss:c.__APP_PATH+"/assets/css/",appJS:c.__APP_PATH+"/assets/js/"},a=document,f=window,j={},b={},e=a.getElementsByTagName("script"),h=a.getElementsByTagName("link"),d=function(l,q,s,t,o,m){if(!l){return}if(j[l]){b[l]=false;if(t){t(l,m)}return}if(b[l]){setTimeout(function(){d(l,q,o,t,m,s)},1);return}b[l]=true;var n,u=q||l.toLowerCase().split(/\./).pop().replace(/[\?#].*/,"");if(u==="js"){n=a.createElement("script");n.setAttribute("type","text/javascript");n.setAttribute("src",l)}else{if(u==="css"){n=a.createElement("link");n.setAttribute("type","text/css");n.setAttribute("rel","stylesheet");n.setAttribute("href",l);j[l]=true}}if(!n){return}if(o){n.charset=o}var p=e[0],r=a.getElementsByTagName("head")[0];if(u==="css"){s?p.parentNode.insertBefore(n,p):r.appendChild(n);if(t){t()}return}n.onload=n.onreadystatechange=function(){if(!this.readyState||this.readyState==="loaded"||this.readyState==="complete"){j[this.getAttribute("src")]=true;if(t){t()}n.onload=n.onreadystatechange=null}};s?p.parentNode.insertBefore(n,p):r.appendChild(n)},g={include:function(m,l,o){var n=typeof m=="string"?[m]:m,l=l||k.sysPlugin;c.foreach(n,function(){if(this.indexOf("/")!=-1){var u="js",t=l+this.replace(/^\s|\s$/g,"")+"index.js",s="script",r=' type="text/javascript" ',v='src="'+t+'"'}else{var w=this.replace(/^\s|\s$/g,""),q=w.split("."),u=q[q.length-1].toLowerCase(),p=u==="css",t=l+w,s=p?"link":"script",r=p?' type="text/css" rel="stylesheet" ':' type="text/javascript" ',v=(p?"href":"src")+'="'+t+'"'}if(!j[t]){document.write("<"+s+r+v+"></"+s+">");j[t]=true}})},use:function(o,p){var m=o.replace(/^\s|\s$/g,""),n=0,l=setInterval(function(){n++;if(n>1000){clearInterval(l);return}if(c.Mods[m]){clearInterval(l);p.call(c.Mods[m])}},1)}};c.foreach(e,function(){j[this.src]=true});c.foreach(h,function(){j[this.href]=true});c.mix(c,[k,g])})(ICAT);ICAT.add("Util",function(a){var b={tdMerge:function(l,h,c){if(!a.isString(l)||l.indexOf("}")==-1){return}var g,m="";g=l.split("{");for(var f=0,e=g.length;f<e;f++){if(g[f].indexOf("}")==-1){m+=g[f]}else{var j=g[f].split("}"),k=h[j[0]];m+=(k?k:(c?"{"+j[0]+"}":""))+j[1]}}return m},New:function(d,e){function c(){d.init.apply(this,e)}a.mix(c.prototype,d,"^init");return new c()},delay:function(e,f){var d=0;if(typeof e=="undefined"){var c=setInterval(function(){d++;if(d>1000){clearInterval(c);return}if(e){clearInterval(c);f.call(this)}},1000)}},focusBox:function(d,c){var e=$(d),f=c||e.val();if(!e.length){return}e.focus(function(){if(this.value==f){this.value=""}}).blur(function(){if(this.value==""){this.value=f}})},tipNum:function(d,h){var g=$(d),c=g.attr("maxlength"),j=g.siblings(h),f=a.browser.msie?"propertychange":"input focus blur",e=function(m){var l=m.val(),k=l.replace(/[^\x00-\xFF]/g,"**").length;j.html("\u60a8\u5df2\u7ecf\u8f93\u5165\u4e86:"+k+"\u4e2a\u5b57\u7b26\uff0c\u8fd8\u5269"+(c-k)+"\u4e2a");if(c-k<=0){m.val(l.substring(0,c))}};if(!g.length&&!j.length){return}e(g);g.bind(f,function(){e(g)})},tipShow:function(f){var h={aimCla:".J_aimObject",tipId:"#J_tipBox",offsetX:0,offsetY:0},d=a.extend(h,f),e=C(d.aimCla),g=e.offset(),j=d.tipId.replace(/(#)/g,"");if(!e.length){return}if(!C(d.tipId).length){C("body").append('<div id="'+j+'" class="tip-box"></div>');var c=C("body").find(d.tipId)}else{var c=C("body").find(d.tipId)}e.hover(function(){c.css({left:(g.left+d.offsetX)+"px",top:(g.top+d.offsetY)+"px"}).html(e.attr("data-tipText")).show()},function(){c.hide()})},pwdStrength:function(){var f=function(g){if(g>=48&&g<=57){return 1}if(g>=65&&g<=90){return 2}if(g>=97&&g<=122){return 4}else{return 8}},d=function(g){modes=0;for(i=0;i<4;i++){if(g&1){modes++}g>>>=1}return modes},c=function(g){if(g.length<=4||/^\d*$/g.test(g)){return 0}Modes=0;for(i=0;i<g.length;i++){Modes|=f(g.charCodeAt(i))}return d(Modes)},e=function(l,k){var h=["pwd0","pwd1","pwd2"],m=l.siblings(".J_pwdSafe");if(k==null||k==""){var g=m.attr("data-class");m.removeClass(g);m.siblings("span").show()}else{var j=c(k);m.siblings("span").hide();switch(j){case 0:var g=m.attr("data-class");m.removeClass(g).addClass(h[0]);m.attr("data-class",h[0]);break;case 1:var g=m.attr("data-class");m.removeClass(g).addClass(h[1]);m.attr("data-class",h[1]);break;case 2:var g=m.attr("data-class");m.removeClass(g).addClass(h[2]);m.attr("data-class",h[2]);break}}return};$(".J_pwdStrength").bind("blur keyup",function(){e($(this),this.value)})},form2str:function(h){if(!h){return}var c="";for(var g=0,f=h.elements,e=f.length;g<e;g++){var d=$(f[g]);if(d.attr("name")){c+="&"+d.attr("name")+"="+f[g].value}}c=c.replace("&","?");return c},form2json:function(h){if(!h){return}var c={};for(var g=0,f=h.elements,e=f.length;g<e;g++){var d=$(f[g]);if(d.attr("name")){c[d.attr("name")]=f[g].value}}return c}};a.mix(b)});(function(a,b){a.mix({cQuery:function(){return b.apply(this,arguments)},getScript:function(d,c,f){var e=a.isString(d)?[d]:d,c=c||a.sysPlugin;a.foreach(e,function(){var g=c+this.replace(/^\s|\s$/g,"")+(this.indexOf("/")!=-1?"index.js":"");b.get(g,undefined,f,"script")})}});a.namespace("DOM","Event");a.DOM={query:function(){var d=[],c=b.apply(this,arguments);c.each(function(){d.push(this)});return d},get:function(){return b.apply(this,arguments).get(0)}};a.Event={_args:function(c){var d=[],e=[];a.each(c,function(g,f){g===0?e.push(f):d.push(f)});e.push(d);return e},on:function(){var c=this._args(arguments);b(c[0]).bind.apply(b(c[0]),c[1])},live:function(){var c=this._args(arguments);b(c[0]).live.apply(b(c[0]),c[1])}}})(ICAT,jQuery);
