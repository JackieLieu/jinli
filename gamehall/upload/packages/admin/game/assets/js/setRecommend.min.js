$(function(){var h=function(i){this.$id=i;};h.prototype.getValArr=function(){var i=[],o;$(this.$id).each(function(p){o=$(this).attr("value");if(!o){return;
}i[p]=o;});return i;};var b=function(i,p,r){var s="#file li:eq("+i+")",t="#file "+p,q='#preview [name="file"] li:eq('+i+")",o='#preview [name="file"] '+p;
$(s)[r](t);$(t)[r](s);$(q)[r](o);$(o)[r](q);};var a=function(i,p,r){var s='#recommend [name="list"]:eq('+i+")",t="#recommend "+p,q='#previewRecommend [name="list"]:eq('+i+")",o="#previewRecommend "+p;
$(s)[r](t);$(t)[r](s);$(q)[r](o);$(o)[r](q);};var j=pageData;j.rollOut=false;window.toUrl=window.toUrl||"";j.toUrl=toUrl;$('#preview [name="file"]').on("click","li",function(){var o=$(this).attr("data-value"),p=$('#preview [name="rollContainer"] div').eq(o),i=$('#preview [name="rollContainer"] .on');
if(parseInt(p.css("left"))<=0){return;}j.rollOut=true;i.removeClass("on");i.animate({left:"404px"},300);p.animate({left:"0px"},300,function(){j.rollOut=false;
p.addClass("on");});});$("#file").on("click",'[name="left"]',function(){var r=$("#file").find('[name="left"]'),o=r.index(this),q=r.length-1,i="insertBefore",p;
if(j.rollOut){return;}if(!o){p="li:eq("+q+")";}else{p="li:eq("+(o-1)+")";}b(o,p,i);$("#preview li:eq(0)").trigger("click");});$("#file").on("click",'[name="right"]',function(){var r=$("#file").find('[name="right"]'),i=r.index(this),q=r.length-1,p="insertAfter",o;
if(j.rollOut){return;}if(i>=q){o="li:eq(0)";}else{o="li:eq("+(i+1)+")";}b(i,o,p);$("#preview li:eq(0)").trigger("click");});$("#recommend").on("click",'[name="top"]',function(){var r=$("#recommend").find('[name="top"]'),o=r.index(this),q=r.length-1,i="insertBefore",p;
if(!o){p='[name="list"]:eq('+q+")";}else{p='[name="list"]:eq('+(o-1)+")";}a(o,p,i);});$("#recommend").on("click",'[name="bottom"]',function(){var r=$("#recommend").find('[name="bottom"]'),i=r.index(this),q=r.length-1,p="insertAfter",o;
if(i>=q){o='[name="list"]:eq(0)';}else{o='[name="list"]:eq('+(i+1)+")";}a(i,o,p);});$("#save").click(function(){var q=new h("#file li"),i=new h('#recommend [name="list"]'),p=$("#saveForm"),o;
if(!p.length){return;}o={dataType:"json",data:{banner:JSON.stringify(q.getValArr()),recommend:JSON.stringify(i.getValArr())},success:function(r){ajaxLoader.hide();
confirmInfo="";ajaxRedirect(r,j.toUrl);}};ajaxLoader.show();p.ajaxSubmit(o);});$("#saveForm").on("click",'[name="del"]',function(){var i=$(this).attr("val");
if(confirm("此操作不可恢复，确定要删除吗？")){$.get(i,function(o){if(o.success){confirmInfo="";if(o.data.href){location.href=o.data.href;}else{location.reload();}}else{$("#alert").dialog("open");
$('#alert [name="msg"]').html(o.msg);}});}});$("#saveForm").on("click",'[name="edit"],[name="add"]',function(){var i=$(this).attr("val");confirmInfo="";
location.href=i;});$("#alert").dialog({autoOpen:false,width:400,buttons:{Ok:function(){$(this).dialog("close");}}});j.imgUrl=imgUrl;j.data.sameDay.imgUrl=j.imgUrl;
var e=template("rollHtml",{supplies:j.data.roll}),k=template("sameDayHtml",j.data.sameDay),n=template("sameDayHtmlSet",j.data.sameDay),d=template("noticeHtmlSet",j.data.notice),l=template("fileHtml",{imgUrl:j.imgUrl,supplies:j.data.roll}),f=template("recommendHtmlSet",{imgUrl:j.imgUrl,supplies:j.data.recommend}),m=template("recommendHtml",{supplies:j.data.recommend});
$("#file").html(l);$("#sameDay").html(k);$("#notice").html(j.data.notice.info||"文字公告空");$('#preview [name="rollContainer"]').html(e);$("#previewRecommend").html(m);
$("#recommend").html(f);$("#setSameDay").html(d+n);var c=j.data.roll.length;for(var g=0;g<c;g++){$('#preview [name="file"] li').eq(g).html(j.data.roll[g].name);
}});