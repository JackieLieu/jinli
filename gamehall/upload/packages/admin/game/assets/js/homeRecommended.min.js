$(function(){var f=function(i){this.$id=i;};f.prototype.getValArr=function(){var i=[],l;$(this.$id).each(function(m){l=$(this).attr("value");if(!l){return;
}i[m]=l;});return i;};var b=function(i,m,o){var p="#file li:eq("+i+")",q="#file "+m,n='#preview [name="file"] li:eq('+i+")",l='#preview [name="file"] '+m;
$(p)[o](q);$(q)[o](p);$(n)[o](l);$(l)[o](n);};var a=function(i,m,o){var p='#recommend [name="list"]:eq('+i+")",q="#recommend "+m,n='#previewRecommend [name="list"]:eq('+i+")",l="#previewRecommend "+m;
$(p)[o](q);$(q)[o](p);$(n)[o](l);$(l)[o](n);};var j=pageData;j.rollOut=false;window.toUrl=window.toUrl||"";j.toUrl=toUrl;j.imgUrl=imgUrl;$('#preview [name="file"]').on("click","li",function(){var l=$(this).attr("data-value"),m=$('#preview [name="rollContainer"] div').eq(l),i=$('#preview [name="rollContainer"] .on');
if(parseInt(m.css("left"))<=0){return;}j.rollOut=true;i.removeClass("on");i.animate({left:"404px"},300);m.animate({left:"0px"},300,function(){j.rollOut=false;
m.addClass("on");});});$("#file").on("click",'[name="left"]',function(){var o=$("#file").find('[name="left"]'),l=o.index(this),n=o.length-1,i="insertBefore",m;
if(j.rollOut){return;}if(!l){m="li:eq("+n+")";}else{m="li:eq("+(l-1)+")";}b(l,m,i);$("#preview li:eq(0)").trigger("click");});$("#file").on("click",'[name="right"]',function(){var o=$("#file").find('[name="right"]'),i=o.index(this),n=o.length-1,m="insertAfter",l;
if(j.rollOut){return;}if(i>=n){l="li:eq(0)";}else{l="li:eq("+(i+1)+")";}b(i,l,m);$("#preview li:eq(0)").trigger("click");});$("#recommend").on("click",'[name="top"]',function(){var o=$("#recommend").find('[name="top"]'),l=o.index(this),n=o.length-1,i="insertBefore",m;
if(!l){m='[name="list"]:eq('+n+")";}else{m='[name="list"]:eq('+(l-1)+")";}a(l,m,i);});$("#recommend").on("click",'[name="bottom"]',function(){var o=$("#recommend").find('[name="bottom"]'),i=o.index(this),n=o.length-1,m="insertAfter",l;
if(i>=n){l='[name="list"]:eq(0)';}else{l='[name="list"]:eq('+(i+1)+")";}a(i,l,m);});$("#save").click(function(){var n=new f("#file li"),i=new f('#recommend [name="list"]'),m=$("#saveForm"),l;
if(!m.length){return;}l={dataType:"json",data:{banner:JSON.stringify(n.getValArr()),recommend:JSON.stringify(i.getValArr())},success:function(o){ajaxLoader.hide();
ajaxRedirect(o,j.toUrl);}};ajaxLoader.show();m.ajaxSubmit(l);});$("#saveForm").on("click",'[name="del"]',function(){var i=$(this).attr("val");if(confirm("此操作不可恢复，确定要删除吗？")){$.get(i,function(m){if(m.success){var l=location.href;
l=l.split("&from");location.href=l[0];}else{$("#alert").dialog("open");$('#alert [name="msg"]').html(m.msg);}});}});$("#alert").dialog({autoOpen:false,width:400,buttons:{Ok:function(){$(this).dialog("close");
}}});var d=template("rollHtml",{supplies:j.data.roll}),h=template("listHtmlSet",{imgUrl:j.imgUrl,supplies:j.data.recommend}),k=template("fileHtml",{imgUrl:j.imgUrl,supplies:j.data.roll}),g=template("listHtml",{imgUrl:j.imgUrl,supplies:j.data.recommend});
$("#file").html(k);$('#preview [name="rollContainer"]').html(d);$("#previewRecommend").html(g);$("#recommend").html(h);var c=j.data.recommend.length;for(var e=0;
e<c;e++){if(j.data.recommend[e].type=="news"){$("#news").hide();}if(j.data.recommend[e].type=="active"){$("#active").hide();}}});