/*!
 * Copyright 2011~2013, ICAT JavaScript Library 1.1.6
 * https://github.com/valleykid/icat
 *
 * Copyright (c) 2013 valleykid
 * Licensed under the MIT license.
 *
 * @Author valleykiddy@gmail.com
 * @Time 2014-02-27 14:18:06
 */
;(function(f,g,a,d){var e=f[a]||{version:"1.1.6"};if(typeof exports!=="undefined"){if(typeof module!=="undefined"&&module.exports){exports=module.exports=e}exports.ICAT=e}else{f[a]=e}e.Shim=f.SHIM||{};e.$=f.jQuery||f.Zepto||f.ender||f.$;c(["String","Boolean","Function","Array","Object","Number"],function(j){e["is"+j]=function(k){if(k===d||k===null){return false}return Object.prototype.toString.call(k).slice(8,-1)===j}});c({DebugMode:/debug/i,DemoMode:/file\:\/\/|localhost|dev\.|demo\.|\/{2}\d+(\.\d+){3}/i,IPMode:/\/{2}\d+(\.\d+){3}/},function(l,j){e[j]=l.test(location.href)});i(e,{mix:i,foreach:c,isjQueryObject:function(j){return e.$&&(j instanceof e.$)},isEmptyObject:function(k){for(var j in k){return false}return true},hasItem:function(l,k){if(e.isArray(l)){if("indexOf" in l){return l.indexOf(k)>-1}var j;c(l,function(m){if(m===k){return !(j=true)}});return j}if(e.isObject(l)){return k in l}if(e.isString(l)){return l.indexOf(k)>-1}return false},delItem:function(j,k){c(j,function(l,m){if(l===k){j.splice(m,1)}})},unique:h,toArray:function(k){var j=[];c(k,function(l){j.push(l)});return j},namespace:function(){var m=arguments,k=m.length,s=null,q,n,r;for(q=0;q<k;++q){r=(""+m[q]).split(".");s=this;for(n=(f[r[0]]===s)?1:0;n<r.length;++n){s=s[r[n]]=s[r[n]]||{}}}return s},exports:{},app:function(j,m){var k=e.isString(j),l=k?f[j]||{}:j;i(l,e,["namespace"],true);i(l,e.isFunction(m)?m():m);k&&(e.app[j]=f[j]=l);return l},util:function(j,k){if(e.isString(j)){e.util[j]=k}else{if(e.isFunction(j)){i(e.util,j())}else{i(e.util,j)}}},widget:function(j,k){if(!e.isString(j)){return}e.widget[j]=e.isFunction(k)?k():k},wait:function(j,l,p){l=l||100;p=p||10;var q=e.__cache_timers=e.__cache_timers||{};var k=0,n,m="icat_timer"+Math.floor(Math.random()*1000000+1);(n=function(){j(m,k===l,q);if(k<=l&&q[m]===false){setTimeout(function(){k+=p;n()},p)}})()},rent:function(l,k,j){if(e.isFunction(k)){e.util[l]=function(m){e.mix(m,j);k(m)}}else{e.widget(l,k)}},ready:function(p){var m=[],l=g.documentElement,q=l.doScroll,n,k=(q?/^loaded|^c/:/^loaded|c/).test(g.readyState),j=function(r){k=1;while(r=m.shift()){r()}};if(g.addEventListener){g.addEventListener("DOMContentLoaded",n=function(){g.removeEventListener("DOMContentLoaded",n,false);j()},false)}if(q){g.attachEvent("onreadystatechange",n=function(){if(/^c/.test(g.readyState)){g.detachEvent("onreadystatechange",n);j()}})}return(p=q?function(r){self!=top?k?r():m.push(r):function(){try{l.doScroll("left")}catch(s){return setTimeout(function(){p(r)},50)}r()}()}:function(r){k?r():m.push(r)})}(),log:function(l){if(!e.DebugMode&&!e.DemoMode){return}if(!!g.all){f.console&&console.log?console.log(l):alert(l)}else{try{__$abc_ICAT()}catch(k){var j=k.stack.replace(/\n\s+at\s+<.*>/g,"").split("\n")[2];j=j.replace(/.*[\(\s]|\).*/g,"").replace(/(.*):(\d+):\d+/g,"$1  line $2:\n");console.log(j,l)}}}});function c(r,j,m,q){var l,n=0,p=r.length,k=q||p===d;if(m){if(k){for(l in r){if(j.apply(r[l],m)===false){break}}}else{for(;n<p;){if(j.apply(r[n++],m)===false){break}}}}else{if(k){for(l in r){if(j.call(r[l],r[l],l)===false){break}}}else{for(;n<p;n++){if(j.call(r[n],r[n],n)===false){break}}}}}function i(j,w,n,m,v){if(!w||!j){return j}if(m===d){m=true}if(v===d){v=true}var q,k,t,u=true;if(n&&e.isString(n)){n=n.replace(/\s+/g,"").split(",");u=false}if(n&&(t=n.length)){if(u){for(q=0;q<t;q++){k=n[q];if(!w[k]){continue}if(e.isFunction(m)){m=m(j,w,k)}v?b(j,w,k,m):(m&&(j[k]=w[k]))}}else{for(k in w){if(!e.hasItem(n,k)){if(e.isFunction(m)){m=m(j,w,k)}v?b(j,w,k,m):(m&&(j[k]=w[k]))}}}}else{for(k in w){if(e.isFunction(m)){m=m(j,w,k)}v?b(j,w,k,m):(m&&(j[k]=w[k]))}}return j}function b(n,m,t,l){if(!l||!n){return}var k=n[t],j=m[t];if(e.isObject(k)){if(e.isObject(j)&&!e.isEmptyObject(j)){for(var q in j){b(k,j,q,true)}}else{n[t]=j}}else{if(e.isArray(k)){n[t]=h(k.concat(j))}else{if(e.isObject(j)&&!e.isEmptyObject(j)){for(var q in j){b(n[t]||(n[t]={}),j,q,true)}}else{if(e.isArray(j)){n[t]=j.concat()}else{n[t]=j}}}}}function h(j){var l={},k=[];c(j,function(n){var m=JSON.stringify(n);if(!l[m]){k.push(n);l[m]=true}});return k}})(this,document,"ICAT");(function(l,m,g){g.ModConfig=function(p){g.mix(g.ModConfig,p)};(g.PathConfig=function(w){var t=g.PathConfig;if(!t._hasReady){var v=m.getElementsByTagName("script"),u=v[v.length-1],p=u.hasAttribute?u.src:u.getAttribute("src",4),s=u.baseURI||m.baseURI||m.URL,r=u.getAttribute("data-main"),q=u.getAttribute("data-cssfile");t.weinreRef=g.IPMode?s.replace(/(^\w+:\/{2,}[^\/]+).*/g,"$1:8080"):"";t.timestamp=g.hasItem(p,"?")?p.replace(/[^?]+\?/g,"?"):"";t.staticRef=p.replace(/(^\w+:\/{2,}[^\/]+).*/g,"$1");t.sysRef=p.replace(/^\w+:\/{2,}[^\/]+|[^\/]+$/g,"");if(r){r=f(r,t.sysRef)[0];t.appRef=r.replace(/[^\/]+$/g,"");q=q?f(q)[0]:"";t.mainScript=[q,r]}else{t.appRef=t.sysRef}t.picPath=h(f("../../pic/"))[0].replace(/[^\/]+$/g,"");t.LoadedGroup={};t.ModGroup={};t._hasReady=true}if(w){if(w.picPath){var x=w.picPath.replace(/(\w)$/,"$1/");x=h(f(x))[0];w.picPath=x.replace(/[^\/]+$/g,"")}g.mix(t,w)}})();g.mix(g,{inc:function(p){if(!p){return}p=f(p);g.foreach(h(p),function(q){if(!q){return}i(q)})},include:function(){if(!arguments.length){return}arguments.length==1?a(g.isObject(arguments[0])?arguments[0]:{files:arguments[0]}):a({files:arguments[0],callback:arguments[1],isDepend:arguments[2],isCombo:arguments[3]})},require:function(){if(!arguments.length){return}arguments.length==1?a(arguments[0],true):a({modName:arguments[0],files:arguments[1],callback:arguments[2],isCombo:arguments[3]},true)},use:function(){if(!arguments.length){return}arguments.length==1?j(arguments[0]):j({modName:arguments[0],callback:arguments[1],delay:arguments[2]||500,step:arguments[3]})}});g.ModConfig({"$MVC":"./mvc","$Event":"./event","$Dom":"./dom","$util":"./utils",appmvc:["$MVC","./mvc/view.js","./mvc/model.js","./mvc/controller.js"],"$Zepto":"../../lib/zepto/zepto","$jQuery":"../../lib/jquery/jquery","$angular":"../../lib/angular/angular","$bootstrap":"../../lib/bootstrap/js/bootstrap"});g.weinreStart=function(){var q=g.PathConfig,p;if(!q.weinreRef){return}p=q.weinreRef+"/target/target-script-min.js#anonymous!";g.include(p)};if(!/MSIE\s?[6-8]/.test(navigator.userAgent)&&g.IPMode){g.weinreStart()}g.include({files:g.PathConfig.mainScript,domReady:false});function i(q){var p=b(q),s=q.replace(/(\?|#).*$/,""),r=g.PathConfig.LoadedGroup;if(r[s]){return}var u=s.match(/[^\.]+$/)[0],v=/css/i.test(u),x=v?"link":"script",t=v?' type="text/css" rel="stylesheet"':' type="text/javascript"',w=(v?"href":"src")+'="'+p+'"';m.write("<"+x+t+w+(v?"/>":"></"+x+">"));r[s]=true;if(!g.$&&l.$){g.$=l.jQuery||l.Zepto||l.ender||l.$}}function j(p){if(!p||!g.isObject(p)){return}g.wait(function(q,r,s){if(!g.PathConfig.ModGroup[p.modName]){s[q]=false;if(r&&g.ModConfig[p.modName]){delete s[q];a({modName:p.modName,files:g.ModConfig[p.modName],callback:p.callback},true)}return}delete s[q];if(p.callback){p.callback.call(g,l[p.modName])}},p.delay,p.step)}function a(q,r,p){if(!q){return}if(r){if(g.isString(q)){q={modName:q}}if(!g.isObject(q)||!(q.files=q.files||g.ModConfig[q.modName])){return}if(!g.ModConfig[q.modName]){g.ModConfig[q.modName]=q.files}}else{if(g.isString(q)||g.isArray(q)){q={files:q}}if(!g.isObject(q)||!q.files){return}}q._arguments=[];g.foreach(g.isArray(q.files)?q.files:[q.files],function(s){if(/^[\$\w]+[\w\.]+\w+$/.test(s)){g.exports[s]=g.exports[s]||s.replace(/^\$/,"");q._arguments.push(s)}});q.files=h(f(q.files),q.isCombo);if(r){q.isDepend=true}if(q.domReady===undefined){q.domReady=true}(p=function(){if(!q.files.length){return}var s=q.files.shift();if(q.files.length){if(q.isDepend){d({file:s,modName:q.modName,callback:function(){if(!g.$&&l.$){g.$=l.jQuery||l.Zepto||l.ender||l.$}p()}})}else{d({file:s,callback:function(){if(!g.$&&l.$){g.$=l.jQuery||l.Zepto||l.ender||l.$}}});p()}}else{d({file:s,callback:function(u,t){u=g.PathConfig.ModGroup;t=[];if(!g.$&&l.$){g.$=l.jQuery||l.Zepto||l.ender||l.$}g.foreach(q._arguments,function(w){if(typeof g.exports[w]!=="string"){t.push(g.exports[w])}else{var x=g.exports[w].split("."),v=x.shift(),y=o=l[v]||g[v];if(o&&x.length){y=(function(z){while(x.length){var A=x.shift();if(z===g.$){z=z.fn}if(z[A]){z=z[A]}else{z=undefined;break}}return z})(o)}t.push(y);g.exports[w]=y}});if(q.domReady===false){if(q.callback){q.callback.apply(g,t)}if(q.modName){u[q.modName]=true}}else{g.ready(function(){if(q.callback){q.callback.apply(g,t)}if(q.modName){u[q.modName]=true}})}}})}})()}function h(p,v){var u=g.PathConfig,s=[];if(v){var r=[],q=[],t=[];g.foreach(p,function(w){/^\w+/.test(w)?t.push(w):/\.css/i.test(w)?r.push(w):q.push(w)});if(r.length){r=u.staticRef+(r.length===1?r[0]:"/??"+r.join(","));s.push(r)}if(q.length){q=u.staticRef+(q.length===1?q[0]:"/??"+q.join(","));s.push(q)}if(t.length){s=s.concat(t)}}else{g.foreach(p,function(w){s.push((/^\w+/.test(w)?"":u.staticRef)+w)})}return s}function f(r,t){var q=[];if(g.isArray(r)){g.foreach(r,function(u){var s=n(u,t);g.foreach(s,function(v){q.push(k(v))})})}else{var p=n(r,t);g.foreach(p,function(s){q.push(k(s))})}return q}function n(u,v){var x=g.ModConfig,t=g.PathConfig,r=u.charAt(0),q=r==="$"?u:"$"+u,p=[],w;if(/^[\$\w]+[\w\.]+\w+$/.test(u)){if(x[q]){w=x[q];v=v||t.sysRef}else{if(x[u]){w=x[u];v=v||t.appRef}}if(w){if(g.isArray(w)){g.foreach(w,function(s){if(s){p.push([s,v])}})}else{p.push([w,v])}}else{p.push([u])}}else{if(r==="."){p.push([u,v||t.appRef])}else{if(r==="~"){p.push(["/"+u.slice(1)])}else{if(u){p.push([u])}}}}return p}function k(t){var v=t[0].replace(/\s+/g,""),s=t[1]||"",w=/!$/.test(v),r=v.charAt(1),p=/^\w+:\/{2,}.*!$/.test(v);if(!p){v=v.replace(/([\?\#].*|!)$/g,"").replace(/(\w+)(\/?\.{2,})+/g,"$1");v=/\.(js|css)$/i.test(v)?v:v+".js"}if(r==="/"){v=v.replace(/^\.\//,s)}else{if(r==="."){if(!s){v=v.replace(/(\.{2}\/)+/,s)}else{var u=v.match(/\.{2}\//g),q;if(u!=null){q=s.replace(/\/$/,"").split("/");g.foreach(u,function(){if(q.length){q.pop()}else{return false}});if(q.length){q.push("");q=q.join("/")}else{q="/"}v=v.replace(/(\.{2}\/)+/,q)}}}}if(g.DebugMode){v=w||/\.source\./i.test(v)?v:v.replace(/([^\.]+)$/,"source.$1")}return v}function d(r){var q=b(r.file),s,t=r.file.replace(/(\?|#).*$/,""),p=g.PathConfig.LoadedGroup;if(p[t]){if(r.callback){r.callback()}return}s=t.match(/[^\.]+$/)[0];/css/i.test(s)?c(r):e(r)}function c(s,r){var q=b(s.file),t=m.createElement("link"),r=s.pNode||m.head||m.getElementsByTagName("head")[0],p=g.PathConfig.LoadedGroup;t.setAttribute("type","text/css");t.setAttribute("rel","stylesheet");t.setAttribute("href",q);setTimeout(function(){if(s.callback){s.callback()}p[s.file]=true},15);r.appendChild(t)}function e(s,r){var q=b(s.file),t,u=m.createElement("script"),r=s.pNode||m.head||m.getElementsByTagName("head")[0],p=g.PathConfig.LoadedGroup;u.setAttribute("type","text/javascript");u.setAttribute("src",q);u.setAttribute("async",true);if("onload" in u){u.addEventListener("load",t=function(){u.removeEventListener("load",t,false);if(s.callback){s.callback()}p[s.file]=true},false)}else{if(u.readyState){u.attachEvent("onreadystatechange",t=function(){if(/loaded|complete/i.test(u.readyState)){u.detachEvent("onreadystatechange",t);if(s.callback){s.callback()}p[s.file]=true}})}}r.appendChild(u)}function b(q){if(/^\w+:\/{2,}.*!$/.test(q)){return q.slice(0,-1)}var p=g.PathConfig;if(p.timestamp){q=q.replace(/\?([^\?\/]+)$/,"&$1")}return/#|&/.test(q)?q.replace(/(#|&)/,p.timestamp+"$1"):q+p.timestamp}})(this,document,ICAT);