(function(c){var d=$('*[data-pagerole="body"]')[0]||document.body,i=d.id;switch(i){case"weather":c.include("./single/waterfall",function(){var l=0,j=$("#waterfall"),k=j.attr("data-ajaxUrl");j.waterfall({colWidth:"7.5rem",marginLeft:6,marginTop:6,isAnimation:false,ajaxFunc:function(n,m){$.ajax({type:"GET",url:k,cache:false,data:{page:++l},timeout:60000,success:n,error:m})},createHtml:function(m){return'<div class="wf_item_inner"><a href="'+m.link+'" class="thumb"><img class="thumb_img"  src="'+m.img+'" /></a><div class="price"><span>￥'+m.price+"</span></div>";"</div>"}})});break;case"lottery":c.include("./single/jquery.rotate",function(){var r=$(d),o=$("#J_lotteryBoard"),p=$("#J_lotteryBtn"),q=$(".J_dialogBox"),x=$(".J_fullMask"),u=$(".abled"),m=u.attr("data-ajaxurl"),v=1,s=7,l,y=false,A=location.host.split(".")[0];if(A=="apk"){if(window.share&&window.share.getVersionName&&(l=window.share.getVersionName())){var j=l.split(".");j[0]*1<2?y=false:j[1]*1<4?y=false:j[2]*1>=6?y=true:false}}else{if(A=="ios"){if($("#lottery").attr("data-version")=="true"){y=true}}}x.height($(document).height());document.body.addEventListener("touchstart",function(G){var C=$(G.target);if(C.hasClass("abled")){var E=C.attr("data-count")*1;var H=C.attr("data-score")*1;if(E<3){B()}else{if(y){if(E<5){if(H>=50){q.html(z({tip:"本次抽奖需要消耗50分.",confirm:true})).show()}else{q.html(z({tip:"本次抽奖需要消耗50分<br>您的分数已不足50，无法参加抽奖！",txt:"您可以做任务获取分数！"})).show()}}else{q.html(z({tip:"您今天的抽奖机会已全部用完<br>请明天再来试试吧！"})).show()}}else{q.html(z({tip:"您今天的抽奖机会已全部用完!<br>升级新版本可以获得额外的抽奖机会，<br>更有手机S5.1，话费大奖等你拿！"})).show()}}return false}if(C.hasClass("J_close")){q.hide();x.hide();return false}if(C.hasClass("J_fixed")){q.hide();B();return false}if(C.hasClass("submit")){var F=C,D={imei:F.attr("data-imei"),mobile:$("#mobile").val(),nickname:$("#nickname").val(),token:token,code:F.attr("data-code")};if(!/^1[34578][0-9]{9}$/.test(D.mobile)){t(D.mobile?"手机号码错误，请重新填写":"手机号码不能为空");return}if(D.nickname.length<=0){t("昵称不能为空");return}F.removeClass("submit");$.ajax({type:"POST",url:ICAT.DebugMode?"/gou/new/api/lottery/winnerinfo.php":"/api/lottery/winnerinfo",data:D,success:function(I){if(!$.isPlainObject(I)){I=JSON.parse(I)}if(I.success){q.html(k({code:F.attr("data-code"),text:"恭喜您兑奖信息提交成功",awardId:F.attr("data-awardId")},true))}else{F.addClass("submit");t(I.msg)}},error:function(){F.addClass("submit")}});return false}},false);function B(){$.ajax({type:"GET",url:m,cache:false,timeout:5000,success:function(C){if(!$.isPlainObject(C)){C=JSON.parse(C)}if(C.success){u.attr("data-count",C.data.count*1+1);u.attr("data-score",C.data.total_score);var E=new Number(C.data.sort)-7,D=30+(E*60);n({code:C.data.code,text:C.data.award_name,imei:C.data.imei,sort:C.data.sort,mobile:C.data.mobile,nickname:C.data.nickname},D)}else{t(C.msg)}},error:w})}function w(){p.addClass("abled");t("网络超时，请重试")}function n(C,D){if(D===undefined){p.addClass("abled");x.show();C.text="亲，您已经抽中了"+C.text+"，请及时填写兑奖信息！";q.html(k(C)).show()}else{o.stopRotate();o.rotate({angle:0,duration:3000,animateTo:D+1440,callback:function(){p.addClass("abled");x.show();if(C.sort==1||C.sort==4){var E="感谢您的参与，祝您下次中奖！<br>购物大厅祝你新年快乐";q.html(z({tip:E})).show()}else{C.text="亲，您已经抽中了"+C.text+"，请及时完善个人信息以便兑奖！";q.html(k(C)).show()}}})}}function z(E){var C=['<div class="txt">'+E.txt+"</div>"].join("");var D=['<ul class="confirm-bottom">','<li class="J_close">取消</li>','<li class="line J_fixed">确定</li>',"</ul>"].join("");var F=['<div class="bottom">','<span class="btn J_close">确定</span>',"</div>"].join("");return['<div class="main">','<div class="tip">',E.tip,(E.txt?C:""),"</div>",E.confirm?D:F,"</div>"].join("")}function k(E,C){var D=['<div class="wrap">',"<ul>",'<li><input type="text" id="nickname"',E.nickname?(' value="'+E.nickname+'"'):"",' placeholder="昵称"></li>','<li><input type="text" id="mobile" ',E.mobile?('value="'+E.mobile+'"'):"",' placeholder="手机"></li>',"</ul>","<p>","请确保输入正确的手机号，并保持手机畅通！如断网，请截图或记录好中奖编号联系购物大厅-小惠","</p>","</div>"].join("");return['<div class="top">',(E.code?"<h2>中奖编号："+E.code+"</h2>":""),"</div>",'<div class="main'+(C?" no-form":"")+'">','<div class="tip">'+E.text,"</div>",C?"":D,"</div>",'<div class="bottom">',(C?'<span class="btn J_close">确定</span>':'<span class="btn submit" data-awardId="'+E.awardId+'" data-code="'+E.code+'" data-imei="'+E.imei+'">提交</span>'),"</div>"].join("")}function t(D){var C=r.find(".J_msgTip");if(C[0]){C.html(D);C.parent().show()}else{r.append('<div class="msg-tip"><span class="J_msgTip">'+D+"</span></div>");C=r.find(".J_msgTip")}setTimeout(function(){C.parent().hide()},3000)}});break;case"alipay":$(".J_gotop").click(function(j){$("body, html").animate({scrollTop:0},500)});break;case"subject_goods":c.include("./single/waterfall",function(){var l=0,j=$("#waterfall"),k=j.attr("data-ajaxUrl");j.waterfall({colWidth:"7.5rem",marginLeft:6,marginTop:6,isAnimation:false,ajaxFunc:function(n,m){$.ajax({type:"GET",url:k,cache:false,data:{page:++l},timeout:60000,success:n,error:m})},createHtml:function(m){return'<div class="wf_item_inner wf_item_goods"><a href="'+m.href+'" class="thumb"><img class="thumb_img"  src="'+m.img+'" /></a><div class="txt"><a href="'+m.href+'">'+m.title+"</a></div>";"</div>"}})});break;case"recoment":var e=$("#recoment");if(e.length){var h=e.find("input").first();h.focus(function(){this.nextElementSibling.className="active"}).blur(function(){this.nextElementSibling.className=""});e.on("touchstart touchmove mousedown mousemove","button",function(){var j=$(this);j.addClass("active");setTimeout(function(){j.removeClass("active")},1000)}).on("touchend mouseup",function(){$(this).removeClass("active")})}else{e=null}break;case"recommend":var a=$("#J_wrapTop");var b=$("#J_submit");var f=b.attr("data-ajaxurl");var g=function(k){var j=['<div class="remind-wrap">',"<span>您填写的推荐人手机号</span>",'<div class="tel"><i></i>'+k+"</div>","</div>","<p>请关注我们微信号公众号@购物大厅关注抽奖结果</p>"];return j.join("")};b.click(function(){var j=$("#J_tel").val();if(j==""){GOU.showtip("手机号码不能为空");return}if(!/^\d{11}$/.test(j)){GOU.showtip("手机号码格式错误");return}$.ajax({url:f,type:"POST",data:{mobile:j},success:function(k){if(!$.isPlainObject(k)){k=JSON.parse(k)}if(k.success){a.html(g(j))}else{GOU.showtip(k.msg)}},error:function(k){GOU.showtip("提交失败，请重试！")}})});break;case"mjb":$("#J_howCollectEl").click(function(){$("#J_howCollect").toggle("slow")});$("#J_whatMjbEl").click(function(){$("#J_whatMjb").toggle("slow")});break}GOU.fitScreen()})(ICAT);