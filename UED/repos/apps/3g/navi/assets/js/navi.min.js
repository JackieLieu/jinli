$(function(){$.extend($.fn,{hover:function(q){var r=$(this),q=q||"hover";r.each(function(t,s){$(s).on("touchstart",function(){var u=setTimeout(function(){$(s).addClass(q);},50);$(document).one("touchmove touchend",function(){clearTimeout(u);$(s).removeClass(q);});});});}});var i={};var m=window._hmt?window._hmt:[];window.hotWordIndex=0,window.initIndex=1;i.cookie={get:function(r){var t=document.cookie,q=t.indexOf(encodeURIComponent(r)+"="),s;if(q!=-1){q=q+encodeURIComponent(r).length+1;s=t.indexOf(";",q);if(s==-1){s=t.length;}return decodeURIComponent(t.substring(q,s));}return"";},set:function(r,t,q,s,v,u){var x=encodeURIComponent(r),w=encodeURIComponent(t);var q=new Date();q.setTime(q.getTime()+30*30*24*60*60*1000);document.cookie=x+"="+w+"; expires="+q;}};window.hasTouch="touchstart" in window;var k=window.hasTouch?"tap":"click";n();b();e();function n(){var s=new Date(),q=[s.getMonth()+1,s.getDate()],t=window.localStorage.getItem("nav_ads_flag")&&window.localStorage.getItem("nav_ads_flag").split(",")||[0,0],r=$("#nowtime").val()!=""?$("#nowtime").val():[s.getFullYear(),s.getMonth()+1<10?"0"+(s.getMonth()+1):s.getMonth()+1,s.getDate()].join("");$("#J_nav_top_ads .close").on("click",function(){m.push(["_trackEvent","GNnavi数据","顶部Banner广告关闭","导航Banner广告-关闭"]);i.cookie.set("navTopAds",r);var u=$(this);$("#J_nav_top_ads").animate({"margin-top":"-60px"},300,"linear",function(){});});}$("#J_convert").live("click",function(){if(window.localStorage&&window.localStorage.getItem("navi_baidu_hotwords")){var q=window.localStorage.getItem("navi_baidu_hotwords");l(JSON.parse(q));}});function b(){if(window.localStorage&&window.localStorage.getItem("navi_baidu_hotwords")){var q=new Date(),r=window.localStorage.getItem("navi_start_time")||0;if(q.getTime()-r>30*60*1000){p();}else{$(".baidu-hot-words").html("");var s=window.localStorage.getItem("navi_baidu_hotwords");l(JSON.parse(s));}}else{p();}}function p(){var q=$("#api-nav-hotwords").val();if(!q){return;}$.ajax({url:q,type:"get",dataType:"jsonp",success:function(s){var r=s.data;if(r){window.localStorage.setItem("navi_start_time",new Date().getTime());window.localStorage.setItem("navi_baidu_hotwords",JSON.stringify(r));l(r);}else{$(".hot-words-box").hide();}}});}function l(v){var z=v[hotWordIndex],s="",t="",q="",u=v[hotWordIndex+1],y=v[v.length-1],r="";if(hotWordIndex<v.length-1){if(z.text.length+u.text.length<=18){hotWordIndex=hotWordIndex+2;r=window.initIndex==1?" ":' class="anima-fade"';s=z.url?z.url:"http://m.baidu.com/s?from=1670b&word="+encodeURIComponent(z.text);t=u.url?u.url:"http://m.baidu.com/s?from=1670b&word="+encodeURIComponent(u.text);$(".baidu-hot-words").html("<span"+r+"><a onclick=\"_hmt.push(['_trackEvent','GNnav数据','导航搜索-百度热词','导航百度热词搜索'])\" href=\""+s+'">'+z.text+"</a></span><span"+r+"><a onclick=\"_hmt.push(['_trackEvent','GNnav数据','导航搜索-百度热词','导航百度热词搜索'])\" href=\""+t+'">'+u.text+"</a></span>");}else{var x=Math.max(z.text.length,u.text.length),w;r=window.initIndex==1?' class="center" ':' class="anima-fade center"';if(z.text.length==x){hotWordIndex=hotWordIndex+1;w=z;}else{hotWordIndex=hotWordIndex+2;w=u;}q=w.url?w.url:"http://m.baidu.com/s?from=1670b&word="+encodeURIComponent(w.text);$(".baidu-hot-words").html("<span"+r+"><a onclick=\"_hmt.push(['_trackEvent','GNnav数据','导航搜索-百度热词','导航百度热词搜索'])\"  href=\""+q+'">'+w.text+"</a></span>");}}else{hotWordIndex=0;}window.initIndex++;}var a=$(".nav-drapdown-title"),f="nav-drapdown-fixed",o="nav-drapdown-arrow-up",d={};function h(v,q){var u=[];otmpl={img1:"tmpl_img1",img2:"tmpl_img2",img3:"tmpl_img3",words3:"tmpl_words3",words5:"tmpl_words5",link:"tmpl_news_list",hotlink:"tmpl_ads_link",like:"tmpl_like",bread:"tmpl_bread",news:"tmpl_cup_news",video:"tmpl_cup_video",schedule:"tmpl_cup_notice",footer:"tmpl_cup_links"};var t=document.createDocumentFragment();for(var s=0,r=q.data.length;s<r;s++){q.data[s].t_bi=window.t_bi?window.t_bi:"";if(q.data[s]["list"]!=false){var w=template.render(otmpl[q.data[s]["tpl"]],q.data[s]);u.push(w);}}t.innerHTML=u.join("");$("#"+v).html(t.innerHTML);u=null;}$(".nav-drapdown-title").on(k,function(){var r=$(this);var q=r.attr("data-wrap");a.next().hide();a.css({background:"#fff"});if(r.hasClass(o)){a.removeClass(o);r.removeClass(o);}else{if(r.attr("data-wrap")=="cinner100"){r.css({background:"#fae013"});}m.push(["_trackEvent","GNnavi数据","一级栏目展开次数",r.find("h2").text()]);r.next().show();a.removeClass(o);if(r.parent().attr("id")!=="index-hist"){h(q,typeData[q]);}r.addClass(o);}});var c={storage:{},isinit:0,maxnum:8,key:"app",_init:function(){if(c.isinit===1){return true;}else{if(c.isinit===0&&window.localStorage){c.isinit=1;c.storage=window.localStorage;return true;}else{return false;}}},get:function(){if(c._init()){var q=c.storage.getItem(c.key);return JSON.parse(q);}else{return false;}},set:function(s){if(c._init()){var r=c.storage.getItem(c.key);var q=c.storage.getItem(c.key+"Ids");r=JSON.parse(r);q=JSON.parse(q);console.log("appIds");if(r===null){r=[];}if(q===null){q=[];}if(q.indexOf(s.appId)>-1){r.splice(q.indexOf(s.appId),1);q.splice(q.indexOf(s.appId),1);}if(r.length===c.maxnum){r.pop();q.pop();}q.unshift(s.appId);r.unshift(s);r=JSON.stringify(r);q=JSON.stringify(q);c.storage.setItem(c.key,r);c.storage.setItem(c.key+"Ids",q);return true;}else{return false;}}};if(!c.get()){$("#index-hist").hide();}else{$("#index-hist").show();}$(".aText").live("click",function(){var q=$(this).attr("appTxt")?$(this).attr("appTxt").substr(0,4):$(this).text().substr(0,4);var s=$(this).attr("appId");var t=$(this).attr("src");var r={aText:q,appId:s,aHref:t};c.set(r);j();location.href=t;});function j(){var r=c.get()||[];var t=[];t.push("<p>");for(var s=1,q=r.length;s<=q;s++){t.push('<span><a class="aText" src="'+r[s-1].aHref+'" appId="'+r[s-1].appId+'">'+r[s-1].aText+"</a></span>");if(s%4==0){t.push("</p>");if(s!=r.length){t.push("<p>");}}}$("#cinner60").html(t.join(""));}j();g();function g(){$(".tab-nav a").live("click",function(){$(".tab-nav a").removeClass("active");$(".tab-con").addClass("none");$(this).addClass("active");$(".tab-con").eq($(this).index()).removeClass("none");});}function e(r){var q=$(".form-input");$(".form-button").on("click",function(t){var s=r||q.attr("defaultValue");if(q.val()==""){m.push(["_trackEvent","GNnavi数据","导航搜索框点击","导航默认关键字搜索"]);}else{m.push(["_trackEvent","GNnavi数据","导航搜索框点击","导航主动关键字搜索"]);}});}$(".btn-love").on("click",function(){var s=$(this);var r=$(".btn-love .num").text();var q=$("#loveUrl").val();if(s.hasClass("anim-done")){return;}if(q){$.getJSON(q,function(t){if(t.success){$(".btn-love .num").text(+r+1);}});}$(".btn-love").animate({rotateY:"-180deg"},500,"ease-out",function(){s.addClass("anim-done");$(".btn-love").addClass("btn-love-open");$(".btn-love").removeClass("active");});});$(".tools-panel span").on("click",function(){var q=$(this).attr("data-box");if(!$(this).hasClass("active")){$(".topic-box").addClass("none");$(".tools-panel span").removeClass("active");$(this).addClass("active");$("."+q).removeClass("none");}else{$(this).removeClass("active");$("."+q).addClass("none");}});$('input[type="radio"]').on("click",function(){var q=$('input[type="radio"]:checked').val();var r=$('input[type="radio"]').last().val();if(q==r){$(".sel-other").show();$(".sel-default").hide();}else{$(".sel-other").hide();$(".sel-default").show();}});$("#btn-commit1,#btn-commit2").on("click",function(){var w=$(this).attr("id");var s=$('input[type="radio"]:checked').val();var v=$("textarea").val();var r=$('input[name="contact"]').val();var q=$("#topicId").val();var u=$("#feedUrl").val();var t="";if(w==="btn-commit1"){t={token:token,option_num:s,topic_id:q};}else{t={token:token,option_num:s,answer:v,contact:r,topic_id:q};}if(u){$.ajax({url:u,type:"POST",data:t,dataType:"json",success:function(x){if(x.success){$(".topic-feed").html("感谢您的参与！");setTimeout(function(){$(".topic-feed").addClass("none done");$(".btn-feed").removeClass("active");},500);}}});}});$(".topic-vote .ui-radio input").on("click",function(){if($(this).attr("checked")===true&&$(this).val()!=100){$(".btn-vote").addClass("btn-active");}if($(this).attr("checked")==true&&$(this).val()==100){if($(".topic-vote .ui-textarea textarea").val().length>0){$(".btn-vote").addClass("btn-active");}else{$(".btn-vote").removeClass("btn-active");}$("#js-textarea-wrap").show();}else{$("#js-textarea-wrap").hide();}});$(".topic-vote .ui-textarea textarea").on("keyup",function(){if($(this).val().length>0){if(!$(".btn-vote").hasClass("btn-active")){$(".btn-vote").addClass("btn-active");}}else{$(".btn-vote").removeClass("btn-active");}});$(".btn-vote").on("click",function(){var q=$(this).data("url");var r=$(".ui-textarea textarea").val()||"";$.ajax({url:q,type:"post",data:{answer:$(".ui-textarea textarea").val(),topic_id:$("#topicId").val(),option_num:$(".ui-radio input:checked").val(),token:token},dataType:"json",beforeSend:function(){$(".topic-vsuccess").addClass("topic-vsuccess-ease");},success:function(s){$(".vote-result li").each(function(t,u){if(s.data.checked==$(u).find("input").val()){$(u).find("input").attr("checked","checked");}$(u).find("span").eq(0).css({width:s.data.percent[t]});$(u).find("span").eq(2).html(s.data.percent[t]);});$(".topic-vote").addClass("none");$(".vote-result").removeClass("none");$(".topic-vsuccess").removeClass("topic-vsuccess-ease");}});});});