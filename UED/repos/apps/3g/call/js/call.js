require(["./pro","./ajax"],function(){setTimeout(window.scrollTo(0,10),100);function b(e,f){var g=window._hmt||[];g.push(["_trackEvent","YX-畅聊数据",e,f]);
}$(".call-bottom-bar-span").on("tap",function(){var e=$(".call-bottom-bar-span i").hasClass("btn-call-arrow-down");if(e){$(this).removeClass("done");$(".call-panel-box").addClass("none");
$(".call-bottom-bar-span i").removeClass("btn-call-arrow-down").addClass("btn-call-arrow-up");}else{b("YX-拨号展开","YX-拨号展开次数");$(this).addClass("done");$(".call-panel-box").removeClass("none");
$(".call-bottom-bar-span i").removeClass("btn-call-arrow-up").addClass("btn-call-arrow-down");}});var d="",a=0;$(".button-panel li span").on("tap",function(){var e=$(".call-input-text");
if(!e.hasClass("call-input-actived")){e.addClass("call-input-actived");}d=d+$(this).text();if(d.slice(0,1)==0&&d.length>11){d=d.substring(0,11)+$(this).text();
}else{if(d.length>10){d=d.substring(0,10)+$(this).text();}}e.attr("data-code",1);e.html(d);});$(".call-list").delegate(".ui-item,.call-sta","tap",function(){var e=$(".call-input-text");
e.attr("data-code",1);if(!e.hasClass("call-input-actived")){e.addClass("call-input-actived");}b("YX-通话记录","YX-通话记录拨打次数");var f=$(this).hasClass("ui-item")?$(this).find(".call-tel").data("tel"):$(this).parent().find(".call-tel").data("tel");
$(".call-panel-box").removeClass("none");e.html(f);$(".call-bottom-bar-span").addClass("done");$(".btn-call-arrow-up").addClass("btn-call-arrow-down");
if($(this).hasClass("call-sta")){$("#js-call-calling").trigger("tap");}});$(".call-input-btn").on("tap",function(){var e=$(".call-input-text");var g=e.text();
var f=$(".call-input-text").data("code");if(f==0){return;}d=g.slice(0,-1);$(".call-input-text").html(g.slice(0,-1));});$("#js-call-activeing").on("click",function(){var h=$(this);
var e=h.data("pid"),g=h.data("uid"),f=h.data("url");$.ajax({url:f,type:"post",data:{pid:e,uid:g,token:token},dataType:"json",success:function(i){if(i.success){if(i.data.redirect){h.addClass("none");
$(".ui-panel").html('<a class="ui-button ui-block ui-normal" href="'+i.data.redirect+'"><i class="icon-call-white"></i>免费电话</a>');}}else{var j=$(".call-tips-error");
c(j,i.msg);}}});});$("#js-actionsheet-ok").on("tap",function(){var e=$("#js-call-clear").data("url");if(e){$.get(e,function(f){if(f.success){$(".call-list .ui-item").not($(".call-list .ui-item").first()).remove();
$(".ui-actionsheet-cancel").trigger("tap");}},"json");}});$("#js-call-calling").on("tap",function(){var h=$(this);var g=$(".call-input-text").text();var e=$(this).data("url");
var f=$(".call-input-tips");if(g==_CONFIG_.telphone){c(f,"不能拨打本机号码！");return;}if(g.slice(0,1)==0){if(!(/^0(10|[2]\d{1}|[3-9]\d{2})(\d{7,8})/.test(g))){c(f,"座机号输入不正确！");
return;}}else{if(!(/^1[3|4|5|7|8][0-9]\d{8}$/).test(g)){c(f,"手机号输入不正确！");return;}}if(a!==0){c(f,"系统繁忙，请稍后！");return;}if(!h.hasClass("done")){h.addClass("done");
}if(_CONFIG_.isLogin==="1"){$.ajax({url:e,type:"post",data:{callee:g,token:token},dataType:"json",success:function(k){if(k.success){b("YX-API接口","youxin-api-count");
h.addClass("none");h.removeClass("done");var n=30;m(n);function m(o){$(".ui-button-blue").text("呼叫中("+o+")");o--;if(o>0){tid=setTimeout(function(){m(o);
},1000);a++;}else{if(o==0){$(".ui-button-blue").text("呼叫中").addClass("none");h.removeClass("none");a=0;}}}$(".ui-button-blue").removeClass("none");if($(".call-list .ui-item").first().data("tel")){}var l=$('.call-list .call-tel[data-tel="'+g+'"]').last();
var i=l.size()>0&&l.parent().attr("data-fixed")!="true"?true:false;if(i){if(!l.parent().find(".call-num").size()){l.parent().remove();$('.call-list .ui-item[data-fixed="true"]').last().after('<li class="ui-item"><span class="call-img"></span><span class="call-tel" data-tel="'+g+'">'+g+"<br><i>"+k.data.address+'</i></span><span class="call-num">(<b>2</b>)</span><span class="call-time">'+k.data.callTime+'</span><span class="call-sta icon-calling"></span></li>');
}else{var j=l.parent().find(".call-num b").html();l.parent().remove();$('.call-list .ui-item[data-fixed="true"]').last().after('<li class="ui-item"><span class="call-img"></span><span class="call-tel" data-tel="'+g+'">'+g+"<br><i>"+k.data.address+'</i></span><span class="call-num">(<b>'+(+j+1)+'</b>)</span><span class="call-time">'+k.data.callTime+'</span><span class="call-sta icon-calling"></span></li>');
}}else{$('.call-list .ui-item[data-fixed="true"]').last().after('<li class="ui-item"><span class="call-img"></span><span class="call-tel" data-tel="'+g+'">'+g+"<br><i>"+k.data.address+'</i></span><span class="call-time">'+k.data.callTime+'</span><span class="call-sta icon-calling"></span></li>');
}}else{c(f,k.msg);}}});}else{if(login_url){location.href=login_url;}}});function c(e,g,f){e.removeClass("none").text(g);setTimeout(function(){e.addClass("none").text("");
},f||3000);}$("#link-wrap a").on("click",function(){var e=$(this).attr("href");$(this).attr("href","http://3g.gionee.com/tj/"+e);});});