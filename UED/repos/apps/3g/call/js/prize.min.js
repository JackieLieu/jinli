(function(){$(function(){function r(s){var t=/^dev.|demo.*/g;return t.test(location.host)===true?"/3g/"+s+".php":s;}var a=true;function f(t,s){var z=[];for(var w=0;w<t;w++){z.push([]);for(var u=0;u<s;u++){z[w][u]=w*s+u;}}var v=[];var y=0,x=0,B="Along",A=0;while(y>=0&&y<s&&x>=0&&x<t&&A<t*s){A++;v.push([x,y]);if(B=="Along"){if(y==s-1){x++;}else{y++;}if(y==s-1&&x==t-1){B="Inverse";}}else{if(y==0){x--;}else{y--;}if(y==0&&x==0){break;}}}return v;}var n=0,h=0,d=0,p=300,q,b=f(3,3),l=0,g=0,o=false,m=0,i=document.getElementById("prize-btn"),e={};function k(s){clearInterval(q);l=0;o=false;d=Math.floor(Math.random()*8);console.log(d);g=1;q=setInterval(function(){c(s);},p);}function c(s){if(o==false){if(m==3){clearInterval(q);p=50;q=setInterval(function(){c(s);},p);}if(l==4+Math.floor(Math.random()*4)){clearInterval(q);p=300;o=true;q=setInterval(function(){c(s);},p);}}if(n>=b.length){n=0;l++;}var t=document.getElementById("prize_sel"+n).getAttribute("data-id");if(o==true&&t==s){m=0;document.getElementById("prize-btn").className="prize-btn";j(e.txt);$("#prize-score").html(e.score);clearInterval(q);}if(t==s){document.getElementById("prize_sel"+n).className="prize-curr prize-hit";}else{document.getElementById("prize_sel"+n).className="prize-curr";}if(n>0){h=n-1;}else{h=b.length-1;}document.getElementById("prize_sel"+h).className="prize-prev";n++;m++;}function j(s){$(".poptips .content").html(s);if(e.code==-2){if(!$(".poptips .btn-link")[0]){$(".poptips .button").append('<a class="btn-link" href="'+e.link+'">获取积分</a>');}}$(".poptips").show();}$(".poptips .btn-ok").on("click",function(){if(e.code==-400){location.reload();}$(".poptips").hide();});$("#prize-btn").on("click",function(){if(parseInt($("#prize-num").html())>0){if(a===true&&!$(this).hasClass("prize-btn-active")){$(this).addClass("prize-btn-active");a=false;$.ajax({url:r("/user/lottery/ajaxDrawing"),type:"get",dataType:"json",success:function(s){e={};a=true;if(s.success){if(s.data.redirect){location.href=s.data.redirect;return;}$("#prize-num").html(s.data.prize_num);var t=parseInt($("#prize-score").html());$("#prize-score").html(t-s.data.prize_costs);k(s.data.prize_hit);e.txt=s.data.prize_msg;e.score=s.data.score;}else{if(s.data.prize_error_code==-2){e.code=-2;e.link=s.data.prize_link;j(s.data.prize_msg);}else{j(s.data.prize_msg);}$(".prize-btn").removeClass("prize-btn-active");}},error:function(){e.code=-400;j("数据请求失败，请刷新页面！");$(".prize-btn").removeClass("prize-btn-active");}});}}else{j("今日抽奖次数已用完！");}});});})();