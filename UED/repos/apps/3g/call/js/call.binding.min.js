/*! call 2015-07-09 */
!function(a){function b(){a.ajax({url:"/user/index/sendrndcode",type:"post",data:{mobile:e,token:token},dataType:"json",success:function(b){a(".step1").hide(),a(".step2").removeClass("none"),a(".step3").removeClass("none"),a(".step2 .inp-txt").focus(),c(f),b.success?a("#js_btnsmt").addClass("inp-btn-act"):(a(".toast-wrap").show(),a(".toast-wrap p").html(b.msg),setTimeout(function(){a(".toast-wrap").hide(),a(".toast-wrap p").html("")},1e3))}})}function c(b){return 0>=b?(clearTimeout(d),a("#js_countdown").addClass("none"),void a("#js_recheckcode").removeClass("none")):(a("#js_countdown em").html(--b),void(d=setTimeout(function(){c(b)},1e3)))}var d,e,f=60;a("#js_checkcode").on("click",function(){return(e=a("#inp-mobile").val())?void b():(a(".toast-wrap").show(),a(".toast-wrap p").html("请输入正确的手机号"),void setTimeout(function(){a(".toast-wrap").hide(),a(".toast-wrap p").html("")},1e3))}),a("#js_recheckcode").on("click",function(){e=a("#inp-mobile").val(),a(this).addClass("none"),a("#js_countdown").removeClass("none"),b()}),a(".step2 .inp-txt").on("keyup",function(){4==a(this).val().length?a("#js_btnsmt").addClass("inp-btn-act"):a("#js_btnsmt").removeClass("inp-btn-act")}),a("#js_btnsmt").on("click",function(){var b=a(this),c=a("#ref").val(),d=a("#inp-mobile").val(),e=a(".step2 .inp-txt").val(),f=a("#redirect").val();if(b.hasClass("inp-btn-act")){if(!d)return a(".toast-wrap").show(),a(".toast-wrap p").html("请输入正确的手机号"),void setTimeout(function(){a(".toast-wrap").hide(),a(".toast-wrap p").html("")},1e3);a.ajax({url:"/user/index/verifyrndcode",type:"post",data:{f:c,redirect:f,mobile:d,smscode:e,token:token},dataType:"json",success:function(b){b.success?b.data.redirect&&(location.href=b.data.redirect):(a(".toast-wrap").show(),a(".toast-wrap p").html(b.msg),setTimeout(function(){a(".toast-wrap").hide(),a(".toast-wrap p").html("")},1e3))}})}})}(Zepto);