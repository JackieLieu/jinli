/*!
 *@mode \u4e09\u7ea7\u7ea7\u8054
 *@Author wangwenlong@ttop.com
 *@Date 2012.02.20
 */
(function(a,e){var d=function(l,h){var j={node1:null,node2:null,node3:null};if(!h&&h!=0){return j}for(var k in l){for(var g in l[k].items){for(var i in l[k].items[g].items){j.node3=l[k].items[g].items[i];if(j.node3==h){j.node1=l[k].val;j.node2=l[k].items[g].val;return j}else{j.node3=null}}}}return j},b=function(j,h,g,i){var l=e("<option>").text(h).val(h+"|"+g).attr("title",g);if(g==i){l.attr("selected","selected")}l.appendTo(j)},f=function(i){var j=a.isString(i.s1)?e(i.s1):i.s1,h=a.isString(i.s2)?e(i.s2):i.s2,g=a.isString(i.s3)?e(i.s3):i.s3,m=i.v1||null,l=i.v2||null,k=i.v3||null;e.each(i.d,function(o,n){b(j,o,n.val,m)});j.change(function(){h.html("");g.html("");if(this.selectedIndex==-1){return}var n=this.options[this.selectedIndex].value;e.each(i.d,function(p,o){if(n.replace(/^.*\|/g,"")==o.val){if(o.items){e.each(o.items,function(r,q){b(h,r,q.val,l)})}}});if(h[0].options.length==0){b(h,"...","",l)}h.change()}).change();h.change(function(){g.html("");var n=j[0].options[j[0].selectedIndex].value;if(this.selectedIndex==-1){return}var o=this.options[this.selectedIndex].value;e.each(i.d,function(q,p){if(n.replace(/^.*\|/g,"")==p.val){if(p.items){e.each(p.items,function(s,r){if(o.replace(/^.*\|/g,"")==r.val){e.each(r.items,function(u,t){b(g,u,t,k)})}});if(g[0].options.length==0){b(g,"...","",k)}}}})}).change()};var c={init:function(g){if(g.isArea){if(!g.areaWrap.length){return}c.areaLinkage(CitySelectData,g)}if(g.isIndustry){if(!g.industryWrap.length){return}c.industryLinkage(IndustrySelectData,g)}},areaLinkage:function(k,g){var j=d(k,g.aNode),i={d:k,v1:j.node1,v2:j.node2,v3:j.node3},h=a.mix(g,i);f(h)},industryLinkage:function(k,g){var i=d(k,g.iNode),j={d:k,v1:i.node1,v2:i.node2,v3:i.node3},h=a.mix(g,j);f(h)}};a.widget.linkage=c.init})(ICAT,jQuery);
