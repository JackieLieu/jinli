(function(a,b){a.app("GNG",function(){return{version:"0.6"}});a.mix(GNG,{scrollPic:function(){if(!b("#mainfocus")[0]){return this}a.include("./assets/js/slide.auto.js",function(){var f=b("#mainfocus"),c=f.find("li").length,d=f.find(".ui-slide-scrollbox").width(),h=f.find(".ui-slide-title span"),e=1,g=new SlideAuto();f.find(".ui-slide-scroll").width(d*c*2);g.init({touchId:".mainfocus",loop:true,auto:true})});return this},toggle:function(){if(!b(".JS-handle")[0]){return this}var d=b(".JS-handle"),c=d.prev("ul.J_toggleUL");d.find(".wrap span").toggle(function(){c.show();this.innerHTML="\u6536\u8d77"},function(){c.hide();this.innerHTML="\u5c55\u5f00"});return this},dialog:function(){if(!b("#J_dialogBox")[0]){return this}var g=b("#J_dialogBox"),c=g.next(".dialog-mask"),d=b("#J_submitForm"),f=d.parents("form"),e=f.find("input,select,textarea");d.click(function(k){k.preventDefault();var j={},n=function(o){var i=f.find(".tip");i.find("p").html(o);i.show();setTimeout(function(){i.hide();i.find("p").html("")},3000)};for(var l=0,h=e.length;l<h;l++){if(e.eq(l).attr("required")&&e[l].value==""){e.eq(l).focus();n(e.eq(l).attr("data-null"));return}if(e.eq(l).attr("pattern")){var m=new RegExp(e.eq(l).attr("pattern"));if(!m.test(e[l].value)){e.eq(l).focus();n(e.eq(l).attr("data-error"));return}}j[e.eq(l).attr("name")]=e[l].value}b.post(f.attr("action"),j,function(o){var q=b.parseJSON(o),p=g.width(),i=b(document).width()-40;g.find("p span").html(q.msg);g.css("left",(i-p)/2+"px").show();c.show()})});g.find(".btn a").click(function(){g.hide();c.hide();a.foreach(e,function(){if(b(this).attr("data-setNull")=="true"){this.value=""}})});return this},tearPaper:function(){if(!b("#J_tearPaper")[0]){return this}b("#J_tearPaper a").bind("click",function(d){d.preventDefault();var e=this.href,c=b("#J_tearPaper"),h=c.prev("#mainfocus"),f=c.next("section"),g=c.parent().prev("header.hd");c.addClass("fadeOut");h.addClass("bounceOutUp");g.addClass("bounceOutUp");f.addClass("bounceOutDown");setTimeout(function(){location.href=e},600);setTimeout(function(){c.removeClass("fadeOut");h.removeClass("bounceOutUp");g.removeClass("bounceOutUp");f.removeClass("bounceOutDown")},1000)});return this},textPic:function(){var g=b("#J_textPic");if(!g[0]){return this}var f=g.attr("dt-ajaxUrl"),c=g.siblings(".handle"),e=1,d=function(i,h){b.get(f,{page:i},function(m){var j=b.parseJSON(m),k='<div class="wrap" style="left:'+(h?-48:48)+'em;"><ul>@ph</ul></div>',l="",o=["cor2","cor3","cor3","cor4"],n=h?"\u4e0a\u9875\u4fe1\u606f\u6ca1\u6709\u4e86":"\u4e0b\u9875\u4fe1\u606f\u6ca1\u6709\u4e86";if(!j.success){alert(n);return}if(j.data.curpage==1){c.eq(0).addClass("disable")}if(!j.data.hasnext){c.eq(1).addClass("disable")}c.eq(h?1:0).removeClass("disable");e=j.data.curpage;a.foreach(j.data.list,function(q,p){l+='<li class="'+o[q]+'"><a href="'+p.link+'"><img src="'+p.img+'" alt=""><em><span>'+p.title+"</span></em></a></li>"+(q==1?"</ul><ul>":"")});k=k.replace(/@ph/,l);g.append(k).find(".wrap:first").animate({left:(h?48:-48)+"em"},1000);g.find(".wrap:last").animate({left:0},1000,function(){g.find(".wrap:first").remove()})})};c.eq(0).click(function(){if(b(this).hasClass("disable")){return}d(e-1,true)});c.eq(1).click(function(){if(b(this).hasClass("disable")){return}d(e+1,false)});return this},showMore:function(){if(!b(".J_showMore")[0]){return this}var c=b(".J_showMore"),d=2;c.click(function(e){e.preventDefault();if(c.hasClass("disable")){return}else{var f=c.attr("dt-ajaxUrl");b.get(f,{page:d},function(i){var g=b.parseJSON(i),h="";d=g.data.curpage+1;a.foreach(g.data.list,function(k,j){h+='<li><div class="msg"><span>'+j.react+(j.mobile?j.mobile:"")+"<s>"+j.create_time+'</s></span></div><div class="reply"><p>'+j.reply+"</p></div></li>"});b(".show-order ul").append(h);if(!g.data.hasnext){c.addClass("disable")}})}})}});b(function(){GNG.scrollPic().tearPaper().textPic();GNG.toggle();GNG.dialog();GNG.showMore()})})(ICAT,jQuery);
