/*!
 * Copyright 2011~2013, ICAT JavaScript Library v1.1.4
 * https://github.com/valleykid/icat
 *
 * Copyright (c) 2013 valleykid
 * Licensed under the MIT license.
 *
 * @Author valleykiddy@gmail.com
 * @Time 2013-03-02 15:30:00
 */
(function(){var c=this,f=document,b={version:"1.1.4"};if(typeof exports!=="undefined"){if(typeof module!=="undefined"&&module.exports){exports=module.exports=b}exports.ICAT=b}else{c.ICAT=b}c.SHIM=c.SHIM||{};b.mix=SHIM.mix||function(m,l,o,k){if(!l||!m){return m}if(!k){k=true}var j,n,h;if(o&&(h=o.length)){for(j=0;j<h;j++){n=o[j];if(n in l){if(k||!(n in m)){m[n]=l[n]}}}}else{for(n in l){if(k||!(n in m)){m[n]=l[n]}}}return m};b.mix(Array.prototype,{contain:function(h){return this.indexOf(h)==-1?false:true},remove:function(i){var h=this;h.forEach(function(j,k){if(j===i){h.splice(k,1)}});return h},unique:function(){var h=this,j={},i=[];h.forEach(function(k){if(!j[k]){i.push(k);j[k]=true}});return i}});var a=location.href;["Function","String","Object","Array","Number","Boolean","Undefined","Null"].forEach(function(h){b["is"+h]=function(i){return Object.prototype.toString.call(i)==="[object "+h+"]"}});b.mix(b,{DebugMode:/debug/i.test(a),DemoMode:/localhost|demo/i.test(a),isEmptyObject:function(i){for(var h in i){return false}return true},isjQueryObject:function(h){return typeof $!=="undefined"&&h instanceof $},foreach:function(p,h,l){var k,m=0,n=p.length,j=n===undefined||b.isString(p)||b.isFunction(p);if(l){if(j){for(k in p){if(h.apply(p[k],l)===false){break}}}else{for(;m<n;){if(h.apply(p[m++],l)===false){break}}}}else{if(j){for(k in p){if(h.call(p[k],k,p[k])===false){break}}}else{for(;m<n;){if(h.call(p[m],m,p[m++])===false){break}}}}},Class:function(){var j=arguments,h=j.length;if(!h){return}if(h===1){if(!b.isObject(j[0])){return}var i=j[0],l=function(){i.Create.apply(this,arguments)};b.foreach(i,function(o,n){if(o!="Create"){l.prototype[o]=n}});return l}else{if(!b.isString(j[0])&&!b.isObject(j[1])){return}var m=j[0],i=j[1],k=j[2]||c,l=function(){i.Create.apply(this,arguments)};b.foreach(i,function(o,n){if(o!="Create"){l.prototype[o]=n}});return k[m]=l}},widget:function(i,h){this.Class(i,h,b.widget)},util:function(h,i){if(b.isString(h)){b.util[h]=i}else{b.mix(b.util,h)}},namespace:function(){var k=arguments,h=k.length,r=null,n,m,q;for(n=0;n<h;++n){q=(""+k[n]).split(".");r=this;for(m=(c[q[0]]===r)?1:0;m<q.length;++m){r=r[q[m]]=r[q[m]]||{}}}return r},app:function(h,k){var i=b.isString(h),j=i?c[h]||{}:h;b.mix(j,b,["namespace"],true);b.mix(j,b.isFunction(k)?k():k);i&&(b.app[h]=c[h]=j);return j},log:function(j){if(f.all){c.console!==undefined&&console.log?console.log(j):alert(j)}else{try{__$abc_ICAT()}catch(i){var h=i.stack.split("\n")[2];h=h.replace(/.*[\(\s]|\).*/g,"").replace(/(.*):(\d+):\d+/g,"$1  line $2:\n");console.log(h,j)}}}});var e=Array.prototype.slice,d=function(h){if(!h||!b.isString(h)){return h}if(/\:[\d\*]+/.test(h)){h=h.trim().replace(/\:([\d\*]+)\s*/g,"|$1|").replace(/\|$/g,"");return h.split("|")}else{return h}},g=function(k,n,j,l,i){var h,m=e.call((i||f).querySelectorAll(k));if(!j){h=n=="*"?m:m[n]}else{if(n=="*"){h=[];m.forEach(function(o){l=="*"?h=h.concat(e.call(o.querySelectorAll(j))):h.push(o.querySelectorAll(j)[l||0])})}else{h=e.call(m[n].querySelectorAll(j));h=l=="*"?h:h[l||0]}}return h};b.util({parentIfText:function(h){return"tagName" in h?h:h.parentNode},matches:SHIM.matches||function(m,h){if(b.isjQueryObject(m)){return m.closest(h).length>0}else{if(!h||m==null||m==f.body.parentNode||m==f){return}var j=f.documentElement.webkitMatchesSelector,l=false;if(b.isString(h)){l=j.call(m,h)}else{for(var k=0;k<h.length;k++){l=j.call(m,h[k]);if(l){break}}}return l}},queryOne:function(i,h){if(!i){return[f][0]}if(b.isString(i)){i=d(i);if(b.isString(i)){return e.call((h||f).querySelectorAll(i))[0]}else{if(i.length>4){return}return g(i[0],i[1],i[2],i[3],h)}}else{return i}},queryAll:function(i,h){if(!i){return[f]}if(b.isString(i)){i=d(i);if(b.isString(i)){return e.call((h||f).querySelectorAll(i))}else{if(i.length>4){return}if(i[2]){i[3]=i[3]||"*"}return g(i[0],i[1],i[2],i[3],h)}}else{return i}},addModsWrap:function(q){if(b.isString(q)){q=q.split("~");var n=b.util.queryOne(q[0]),l=q[1].trim().split("*"),o=l[0],j=l[1]||1,p,k="";p=o.replace(/(\w+)([\.\#\w\-\d]+)/,"<$1$2></$1>").replace(/\.([\.\w\-\d]+)/g,' class="$1"').replace(/\./g," ").replace(/\#([\w\-\d]+)/g,' id="$1"');for(var h=0;h<j;h++){k+=p}n.innerHTML=k}else{var m=arguments.callee;q.forEach(function(i){m(i)})}},waitObj:function(k,h){h=h||100;b.__TIMER_CACHE=b.__TIMER_CACHE||{};var j=0,i="icat_timer"+Math.floor(Math.random()*1000000+1);(function(){var l=arguments.callee;k(i,j);if(j<h&&!b.__TIMER_CACHE[i]){setTimeout(function(){j++;l()},1)}})()},lazyLoad:function(i,h){if(!i){return}i=b.util.queryOne(i);var j=e.call(b.util.queryAll('img[src$="blank.gif"]',i));h=h||500;setTimeout(function(){j.forEach(function(m){var l=m.getAttribute("data-src");b.__IMAGE_CACHE=b.__IMAGE_CACHE||{};if(!l){return}if(!b.__IMAGE_CACHE[l]){var k=new Image();k.src=l;k.onload=function(){m.src=l;b.__IMAGE_CACHE[l]=true;k=null}}else{m.src=l}m.removeAttribute("data-src")})},h)},getCurrentJS:function(){var h=f.getElementsByTagName("script");return h[h.length-1]},fullUrl:function(i,j,h){if(!i){return b.PathConfig.pageRef+"?"+h}i=i.replace(/^\//g,"");if(b.DemoMode){i=i.indexOf("?")<0?(i+".php"):i.replace(/(\?)/g,".php$1")}if(!j){i=i+(i.indexOf("?")<0?"?":"&")+h}i=b.PathConfig.pageRef+i;return i}})}).call(this);(function(a,c,f){a.namespace("Event");var b=a.Event,e=function(i,h,g){i.events=i.events||{};i.types=i.types||[];i.events[h]=g;if(i.types.contain(h)){i.types.push(h)}h=h.replace(/\..*/g,"");if(i.addEventListener){i.addEventListener(h,i.events[h],false)}else{if(i.attachEvent){i.attachEvent("on"+h,b[eventId])}else{i["on"+h]=g}}},d=function(i,h){if(!i.events||!i.types.contain(h)){return}var g=i.events[h];h=h.replace(/\..*/g,"");if(i.removeEventListener){i.removeEventListener(h,g,false)}else{if(i.detachEvent){i.detachEvent("on"+h,g)}else{i["on"+h]=null}}if(isEmptyObject(i.events)){i.events=null}if(!i.types.length){i.types=null}};a.mix(b,{preventDefault:function(g){if(g&&g.preventDefault){g.preventDefault()}else{window.event.returnValue=false}},stopPropagation:function(g){if(window.event){window.event.cancelBubble=true}else{g.stopPropagation()}},bindEvent:function(i,h,g){if(!i){return}i=a.util.queryAll(i);if(a.isjQueryObject(i)){i.bind?i.bind(h,g):arguments.callee(a.util.queryAll(i.selector),h,g)}else{i.length===undefined?e(i,h,g):a.foreach(i,function(k,j){e(j,h,g)})}},removeEvent:function(h,g){if(!h){return}h=a.util.queryAll(h);if(a.isjQueryObject(h)){h.unbind?h.unbind(g):arguments.callee(a.util.queryAll(h.selector),g)}else{h.length===undefined?d(h,g):a.foreach(h,function(k,j){d(j,g)})}},triggerEvent:function(j,k,i,h){if(f.createEventObject){var g=f.createEventObject();j.fireEvent("on"+k,g)}else{var l=f.createEvent("Event");l.initEvent(k,i,h);j.dispatchEvent(l)}},ready:function(){var h=[],g=SHIM._ready||function(i){if(f.readyState){(function(){if(f.readyState!=="loading"){i()}else{setTimeout(arguments.callee,10)}})()}};g(function(){if(!arguments.callee.done){arguments.callee.done=true;for(var j=0;j<h.length;j++){h[j]()}}});return function(i){if(a.isFunction(i)){h[h.length]=i}return i}}(),on:function(i,h,g){b.bindEvent(i,h,g)},off:function(h,g){b.removeEvent(h,g)}});b.ready(function(){var o={},j,p="ontouchstart" in c;var r=p?"touchstart":"mousedown",g=p?"touchmove":"mousemove",u=p?"touchend":"mouseup",k="touchcancel",s=function(w,v,y,x){var A=Math.abs(w-v),z=Math.abs(y-x);return A>=z?(w-v>0?"Left":"Right"):(y-x>0?"Up":"Down")};var n=750,i,m=function(){if(i){clearTimeout(i)}i=null};var l=a.util.queryOne("*[data-pagerole=body]"),h,t,q=function(v,w){a.Controller.__CUR_OBSERVERS=a.Controller.__CUR_OBSERVERS||[];a.Controller.__CUR_OBSERVERS.forEach(function(x){a.Controller[x].execute(v,w)})};if(!l){return}b.on(l,r,function(v){if(v.button&&v.button===2){return}var w=p?v.touches[0]:v;h=Date.now();t=h-(o.last||h);o.el=a.util.parentIfText(v.target);j&&clearTimeout(j);o.x1=w.pageX;o.y1=w.pageY;o.isScrolling=undefined;if(t>0&&t<=250){o.isDoubleTap=true}o.last=h;i=setTimeout(function(){i=null;if(o.last){q("longTap",o.el);o={}}},n);b.stopPropagation(v)});b.on(l,g,function(v){if(v.button&&v.button===2){return}m();var y=p?v.touches[0]:v;o.x2=y.pageX;o.y2=y.pageY;var x=o.x2-o.x1,w=o.y2-o.y1;if(typeof o.isScrolling=="undefined"){o.isScrolling=!!(o.isScrolling||Math.abs(x)<Math.abs(w))}if(!o.isScrolling){b.preventDefault(v);q("swiping",o.el,[o.x1,o.x2,o.y1,o.y2]);b.stopPropagation(v)}});b.on(l,u,function(v){if(v.button&&v.button===2){return}m();if(!o.isScrolling){if(o.isDoubleTap){q("doubleTap",o.el);o={}}else{if("last" in o){q("tap",o.el);j=setTimeout(function(){j=null;q("singleTap",o.el);o={}},250)}else{if((o.x2&&Math.abs(o.x1-o.x2)>30)||(o.y2&&Math.abs(o.y1-o.y2)>30)){var w="swipe"+s(o.x1,o.x2,o.y1,o.y2);q(w,o.el);q(w,o.el);o={}}}}}else{o={}}b.stopPropagation(v)});b.on(l,k,function(v){b.preventDefault(v);b.stopPropagation(v);if(j){clearTimeout(j)}if(i){clearTimeout(i)}i=j=null;o={}});b.on(l,"click",function(v){var x=a.util.parentIfText(v.target),w=a.Controller.__CUR_SELECTORS;if(!x||x==f.body){return}(function(){if(a.util.matches(x,w)){b.preventDefault(v);b.stopPropagation(v)}else{if(x.parentNode!==f.body){x=x.parentNode;arguments.callee()}}})()})})})(ICAT,this,document);(function(b,c,f){var d=Array.prototype.slice,a=function(k,n,j){if(!k){return}var i=b.View.__TMPL_CACHE;if(i[k]){return n?i[k](n):i[k]}else{j=/[\.#]/.test(k)?b.util.queryOne(k).innerHTML:(j||"");j=j.replace(/[\r\t\n]/g,"");if(j===""){return j}var l,m="var __p_fun = [];with(jsonData){__p_fun.push('"+j.replace(/<%=(.*?)%>/g,"',$1,'").replace(/<%(.*?)%>/g,"');$1__p_fun.push('")+"');};return __p_fun.join('');";i[k]=new Function("jsonData",m);return n?i[k](n):i[k]}};function h(k,j){var i=this;i.tempId=k;i._render=function(m,l){b.util.waitObj(function(n){var o=b.util.queryOne(m.parentWrap);if(!o){b.__TIMER_CACHE[n]=false;return}b.__TIMER_CACHE[n]=true;m.parentWrap=o;b.View.render(i.tempId,m);var p=/form/i.test(o.tagName)?o:b.util.queryOne("form",o);if(p){i.getData=function(r){r=r||"string";var s=/json/i.test(r),q=s?{}:"";d.call(p.elements).forEach(function(u){var t=u.getAttribute("name"),v=u.value;if(t){s?q[t]=v:q+="&"+t+"="+v}});return s?q:q.replace(/^&/,"")}}})};if(j){i._render(j)}}h.prototype={addItem:function(i){this._render(i)},setData:function(i){this._render(i,true)},extend:function(i){b.mix(this,i)}};b.View=function(i,j){if(!i){return}if(!b.View[i]){b.View[i]=new h(i)}if(j){b.View[i].setData(j)}return b.View[i]};b.mix(b.View,{render:function(s,l,n){b.__APP_TEMPS=b.__APP_TEMPS||{};var j=b.View.__TMPL_CACHE=b.View.__TMPL_CACHE||{},p=l.parentWrap,m,i=f.createElement("div"),q,r=function(o,t){if(!o||!t){return}o=b.isArray(o)?o:[o];o.forEach(function(u){if(!u){return}if(/\w*~.*/.test(u)){u=u.split("~");t.setAttribute(u[0],u[1])}else{var w=u.replace(/[#\.]([\#\.\w\-]+)/g,"$1"),x=t.className;u.indexOf("#")>=0?t.id=w.replace(/[\#\.].*/g,""):t.className=(x.replace(/\s+/,".")+"."+w).split(".").unique().join(" ")}})};if(b.isEmptyObject(b.__APP_TEMPS)){b.foreach(b.app,function(t,o){if(this.template){b.mix(b.__APP_TEMPS,this.template)}})}if(b.isString(s)){s=s.trim()}if(j[s]){m=j[s](l)}else{if(b.isObject(s)){m=a(s,l,b.isjQueryObject(s)?s.html():s.innerHTML)}else{m=a(s,l,b.__APP_TEMPS[s])}}if(!p){return m}i.innerHTML=m;q=i.childNodes;if(l.hooks){b.foreach(l.hooks,function(u,o){var t=b.util.queryAll(u,i);t.length?t.forEach(function(v){r(o,v)}):r(o,t)})}if(l.pHooks){b.foreach(l.pHooks,function(t,o){if(t.indexOf(".")<0){r(o,p)}else{t=t.replace(/(\.)parents\((\d+)\).*/g,"$1$2").split(".");var u=t[1]==0?p:(function(){var w=p;for(var v=0;v<t[1];v++){w=w.parentNode;if(w===f.body){break}}return w})();r(o,u)}})}if(n){var k=p.childNodes;while(k.length>0){p.removeChild(k[0])}}while(q.length>0){p.appendChild(q[0])}i=null;if(l.callback){l.callback(p)}},destroy:function(i){if(!i){return}i=b.isString(i)?[i]:i;i.forEach(function(j){delete b.View[j]})}});function g(j,i){this.module=j;this.initData=i}g.prototype={getInitData:function(i){return this.initData[i||""]},extend:function(i){b.mix(this,i)}};b.Model=function(i,j){if(!i){return}if(!b.Model[i]){b.Model[i]=new g(i,j)}else{b.Model[i].initData=j||b.Model[i].initData}return b.Model[i]};b.mix(b.Model,{storage:function(){if(!arguments.length||!window.localStorage||!window.sessionStorage){return}var i=window.localStorage,j=window.sessionStorage;if(arguments.length==1){var n=arguments[0];return b.isString(n)?(i.getItem(n)||j.getItem(n)):""}else{var n=arguments[0],l=arguments[1],m=arguments[2];if(b.isString(n)){var k=m?j:i;k.removeItem(n);k.setItem(n,b.isObject(l)?JSON.stringify(l):l)}}},clearStorage:function(k){if(!k||!window.localStorage||!window.sessionStorage){return}var i=window.localStorage,j=window.sessionStorage;if(k==i||k==j){k.clear()}else{if(i[k]){i.removeItem(k)}if(j[k]){j.removeItem(k)}}},cookie:function(){if(!arguments.length){return}if(arguments.length==1){var o=f.cookie;if(o.length<=0){return}var j=arguments[0],k=o.indexOf(j+"=");if(k!=-1){k=k+j.length+1;cEnd=o.indexOf(";",k);if(cEnd==-1){cEnd=o.length}return unescape(o.substring(k,cEnd))}}else{var j=arguments[0],n=arguments[1],m=arguments[2]||60,l=new Date(),i="";l.setTime(l.getTime()+(m*1000));i="; expires="+l.toGMTString();f.cookie=j+"="+escape(n)+i+"; path=/"}},clearCookie:function(i){b.View.cookie(i,"",-1)},destroy:function(i){if(!i){return}i=b.isString(i)?[i]:i;i.forEach(function(j){delete b.Model[j]})}});function e(i){this.selectors=[];this.events={};this.module=i}e.prototype={subscribe:function(j){var i=this;if(!j){return i}j=b.isArray(j)?j:[j];b.foreach(j,function(n,k){k.el=k.el.trim();if(!i.selectors.contain(k.el)){i.selectors.push(k.el)}var m=k.el+"|"+(k.stopDefault?1:0)+"|"+(k.stopBubble?1:0),l=k.eType.trim();switch(l){case"click":l="tap";break;case"longClick":l="longTap";break;case"doubleClick":l="doubleTap";break;case"singleClick":l="singleTap";break;case"moving":l="swiping";break}if(!i.events[l]){i.events[l]={}}if(!i.events[l][m]){i.events[l][m]=k.callback}})},unsubscribe:function(j){var i=this;if(!j){i.events={}}else{j=b.isArray(j)?j:[j];j.forEach(function(k){["|0|0","|0|1","|1|0","|1|1"].forEach(function(l){if(i.events[k.eType.trim()][k.el.trim()+l]){delete i.events[k.eType.trim()][k.el.trim()+l]}})})}},execute:function(o,q,j){var m=this,p,n=m.events[o];if(!n){return}for(p in n){var l=p.split("|"),i=false;(function(r,k){if(b.util.matches(r,l[0])){k.apply(r,j);if(l[1]==0){b.Event.triggerEvent(r,"click",false,true)}i=true}else{if(r&&r.parentNode!==f.body){arguments.callee(r.parentNode,k)}}})(q,n[p]);if(i&&l[2]==1){return}}},addEvents:function(i){this.subscribe(i)},removeEvents:function(i){this.unsubscribe(i)},extend:function(i){b.mix(this,i)}};b.Controller=function(j,i){if(!j){return}if(!b.Controller[j]){b.Controller[j]=new e(j)}if(b.isFunction(i)){i(b.Controller[j])}else{b.Controller[j].subscribe(i)}return b.Controller[j]};b.mix(b.Controller,{addCurrent:function(i){if(!i){return}i=b.isString(i)?[i]:i;b.Controller.__CUR_SELECTORS=b.Controller.__CUR_SELECTORS||[];b.Controller.__CUR_OBSERVERS=b.Controller.__CUR_OBSERVERS||[];i.forEach(function(j){if(!b.Controller.__CUR_OBSERVERS.contain(j)&&b.Controller[j]){b.Controller.__CUR_OBSERVERS.push(j);b.Controller.__CUR_SELECTORS=b.Controller.__CUR_SELECTORS.concat(b.Controller[j].selectors)}})},removeCurrent:function(i){if(!i){return}i=b.isString(i)?[i]:i;b.Controller.__CUR_SELECTORS=b.Controller.__CUR_SELECTORS||[];b.Controller.__CUR_OBSERVERS=b.Controller.__CUR_OBSERVERS||[];i.forEach(function(j){b.Controller.__CUR_OBSERVERS.remove(j);if(b.Controller[j]){b.Controller[j].selectors.forEach(function(k){b.Controller.__CUR_SELECTORS.remove(k)})}})},destroy:function(i){if(!i){return}i=b.isString(i)?[i]:i;b.Controller.__CUR_SELECTORS=b.Controller.__CUR_SELECTORS||[];b.Controller.__CUR_OBSERVERS=b.Controller.__CUR_OBSERVERS||[];i.forEach(function(j){b.Controller.__CUR_OBSERVERS.remove(j);if(b.Controller[j]){b.Controller[j].selectors.forEach(function(k){b.Controller.__CUR_SELECTORS.remove(k)})}delete b.Controller[j]})}})})(ICAT,this,document);(function(c,f,h){c.PathConfig=function(j){var m=c.util.getCurrentJS(),p=m.src;c.PathConfig._isConcat=p.indexOf("??")>=0;if(!c.PathConfig.appRef){var q=m.baseURI,n=c.DemoMode?"(\\w+/)(\\w+)?[^/\\w][\\w\\?\\%\\#\\&\\=]+":"(//[\\w\\.]+/).*",l=new RegExp(n,"g");c.PathConfig.pageRef=q.replace(l,"$1");if(c.PathConfig._isConcat){var k=p.replace(/(\?{2}|\.js(?=\?))/g,"$1|").split("|"),o=k[0].replace(/\?+/g,"");c.PathConfig._webRoot=k[0];c.PathConfig.timestamp=k[2]||"";k[1].split(",").forEach(function(r){if(/\/sys\//i.test(r)){c.PathConfig._sysRef=r.replace(/(\/sys\/).*/ig,"$1")}if(/\/apps\//i.test(r)){c.PathConfig._appRef=r.replace(/(\/)\w+(\.\w+)?\.js/g,"$1")}});c.PathConfig.sysRef=(o+c.PathConfig._sysRef).replace(/([^:])\/{2,}/g,"$1/");c.PathConfig.appRef=(o+c.PathConfig._appRef).replace(/([^:])\/{2,}/g,"$1/")}else{if(j===true){c.PathConfig.sysRef=/\/sys\//i.test(p)?p.replace(/(\/sys\/).*/ig,"$1"):p.replace(/(\/)\w+(\.\w+)?\.js(.*)?/g,"$1");c.PathConfig.timestamp=p.replace(/.*\.js(\?)?/g,"$1")}else{c.PathConfig.appRef=p.replace(/(\/)\w+(\.\w+)?\.js(.*)?/g,"$1");if(!c.PathConfig.timestamp){c.PathConfig.timestamp=p.replace(/.*\.js(\?)?/g,"$1")}}}}if(c.isObject(j)){c.mix(c.PathConfig,j)}};c.PathConfig(true);c.ModsConfig=function(j){if(c.isArray(j)){c.foreach(j,function(m,l){c.ModsConfig[l.modName]=(c.ModsConfig[l.modName]||[]).concat(l.paths)})}else{if(j.modName&&j.paths){c.ModsConfig[j.modName]=(c.ModsConfig[j.modName]||[]).concat(j.paths)}else{c.foreach(j,function(m,l){c.ModsConfig[m]=(c.ModsConfig[m]||[]).concat(l)})}}};var e={},i={},d,b=function(j,m){if(!j.length){return}if(j.length===1){m=true}var l,n=[],k=function(q){var o=q,p=c.PathConfig._isConcat&&!m?"_":"";if(/^\.{1,}\//.test(o)){o=/^\.\//.test(o)?o.replace(/^\.\//g,c.PathConfig[p+"appRef"]):o.replace(/^\.{2}\//g,c.PathConfig[p+"appRef"].replace(/\w+\/$/g,""))}else{if(/^\//.test(o)){o=o.replace(/^\//g,c.PathConfig.pageRef)}else{o=c.PathConfig[p+"sysRef"]+o}}return o};if(c.PathConfig._isConcat&&!m){l="";c.DebugMode?j.forEach(function(o){if(/^(http|ftp|https):\/\//i.test(o)){n.push(o.indexOf("!")>=0?o.replace(/\!/g,""):o.replace(/(\.source)?(\.(js|css))/g,".source$2"))}else{if(/^\//.test(o)){o=k(o);n.push(o.indexOf("!")>=0?o.replace(/\!/g,""):o.replace(/(\.source)?(\.(js|css))/g,".source$2"))}else{o=k(o);l+=(o.indexOf("!")>=0?o.replace(/\!/g,""):o.replace(/(\.source)?(\.(js|css))/g,".source$2"))+","}}}):j.forEach(function(o){o=o.replace(/\!/g,"");if(/^(http|ftp|https):\/\//i.test(o)){n.push(o)}else{if(/^\//.test(o)){n.push(k(o))}else{l+=k(o)+","}}});l=c.PathConfig._webRoot+l.replace(/,$/g,"");return[l].concat(n)}else{l=[];c.DebugMode?j.forEach(function(o){if(/^(http|ftp|https):\/\//i.test(o)){l.push(o.indexOf("!")>=0?o.replace(/\!/g,""):o.replace(/(\.source)?(\.(js|css))/g,".source$2"))}else{o=k(o);l.push(o.indexOf("!")>=0?o.replace(/\!/g,""):o.replace(/(\.source)?(\.(js|css))/g,".source$2"))}}):j.forEach(function(o){o=o.replace(/\!/g,"");if(/^(http|ftp|https):\/\//i.test(o)){l.push(o)}else{l.push(k(o))}});return l}},a=function(o){var m=o,n=m+c.PathConfig.timestamp;if(e[n]){return}var p=m.replace(/.*\./g,""),l=p=="css",k=l?"link":"script",j=l?' type="text/css" rel="stylesheet"':' type="text/javascript"',q=(l?"href":"src")+'="'+n+'"';h.write("<"+k+j+q+(l?"/>":"></"+k+">"));e[m]=true},g=function(l){var j=l.file+c.PathConfig.timestamp;if(e[l.file]){if(l.callback&&c.isFunction(l.callback)){l.callback(l.context||c)}if(l.modName){i[l.modName]=true}return}var m,k=l.file.replace(/.*\./g,"");if(k==="css"){m=h.createElement("link");m.setAttribute("type","text/css");m.setAttribute("rel","stylesheet");m.setAttribute("href",j)}else{if(k==="js"){m=h.createElement("script");m.setAttribute("type","text/javascript");m.setAttribute("src",j);m.setAttribute("async",true)}}if(!m){return}c.util.waitObj(function(n){var o=h.body||h.getElementsByTagName("body")[0];if(!o){c.__TIMER_CACHE[n]=false;return}c.__TIMER_CACHE[n]=true;if(k==="js"){d=SHIM._load||function(t,q,s,r,u,p){u.onload=function(){if(s.callback&&p.isFunction(s.callback)){s.callback(s.context||p)}if(s.modName){t[s.modName]=true}q[s.file]=true};r.appendChild(u)};d(i,e,l,o,m,c)}if(k==="css"){setTimeout(function(){if(l.callback&&_icat.isFunction(l.callback)){l.callback(l.context||_icat)}if(l.modName){i[l.modName]=true}},5);e[l.file]=true;o.appendChild(m)}})};c.mix(c,{inc:function(j){if(!j){return}j=c.isString(j)?[j]:j;c.foreach(b(j),function(l,k){if(!k){return}a(k)})},include:function(){if(!arguments.length){return}if(arguments.length==1){var j=arguments[0];if(c.isString(j)){j={files:j}}if(!c.isObject(j)||!j.files){return}j.files=c.isString(j.files)?b([j.files]):b(j.files,j.isSingle);(function(){if(j.files.length){var l=j.files.shift();l=l}else{return}if(j.files.length){var k=arguments.callee;if(j.isDepend){g({file:l,callback:function(){k(j.files)},context:j.context})}else{g({file:l,context:j.context});k(j.files)}}else{g({file:l,callback:j.callback,context:j.context})}})()}else{arguments.callee({files:arguments[0],callback:arguments[1],isDepend:arguments[2],isSingle:arguments[3],context:arguments[4]})}},require:function(){if(!arguments.length){return}if(arguments.length==1){var j=arguments[0];if(!c.isObject(j)||!(j.files=j.files||c.ModsConfig[j.modName])){return}j.files=c.isString(j.files)?b([j.files]):b(j.files,j.isSingle);if(i[j.modName]){if(j.callback){j.callback(j.context)}}else{(function(){if(j.files.length){var l=j.files.shift();l=l}else{return}if(j.files.length){var k=arguments.callee;g({file:l,callback:function(){k(j.files)},context:j.context,modName:j.modName})}else{g({file:l,callback:j.callback,context:j.context,modName:j.modName})}})()}}else{arguments.callee({modName:arguments[0],files:arguments[1],callback:arguments[2],isSingle:arguments[3],context:arguments[4]})}},use:function(k){if(!arguments.length){return}var j=0,l;if(arguments.length==1){var k=arguments[0];if(!c.isObject(k)){return}c.util.waitObj(function(m,n){if(!i[k.modName]){c.__TIMER_CACHE[m]=false;if(n==50&&c.ModsConfig[k.modName]){c.require({modName:k.modName,files:c.ModsConfig[k.modName],context:k.context})}return}c.__TIMER_CACHE[m]=true;if(k.callback){k.callback(k.context)}})}else{arguments.callee({modName:arguments[0],callback:arguments[1],delay:arguments[2],context:arguments[3]})}}});c.ModsConfig([{modName:"zepto_core",paths:["lib/zepto/src/zepto.js","lib/zepto/src/event.js","lib/zepto/src/ajax.js","lib/zepto/src/fx.js"]},{modName:"app_mvcBase",paths:["./mvc/template.js","./mvc/initdata.js","./mvc/view.js","./mvc/model.js","./mvc/controller.js"]}])})(ICAT,this,document);


(function(iCat){
	iCat.PathConfig();

	//定义命名空间
	iCat.app("GNnav",function(){
		return {
			version:'1.0',
			fullUrl: function(url, isAjax){
				if(!url){
					return iCat.PathConfig.pageRef;
				}
				url = url.replace(/^\//g, '');
				if(iCat.DemoMode){
					url = url.indexOf('?')<0? (url+'.php') : url.replace(/(\?)/g, '.php$1');
				}
				if(!isAjax){
					url = url;
				}
				url = iCat.PathConfig.pageRef + url;
				if(iCat.isDemoMode){
					//url = url.split('/').unique().join('/');
				}

				return url;
			}
		};
	});

	iCat.include(['./jquery.js'],function(){
		//mvc
		iCat.require({modName:'app_mvcBase'});
	});
})(ICAT);