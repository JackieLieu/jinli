(function(a,c){function b(){this.sHtml='<div class="msgMode popWrap hide" style="opacity:0;left:50%; margin-left:-5.5rem; bottom:10%;"></div>';this.wrap=c("#page");this.count=1;}b.prototype={templete:function(){c("#page").append(this.sHtml);},message:function(i,g){var h=c(".msgMode");if(this.count==1){this.templete();}this.count++;c(".msgMode").html(i).removeClass("hide").addClass("show").animate({opacity:1},300,"linear");if(c(".msgMode").hasClass("show")){setTimeout(function(){c(".msgMode").animate({opacity:0},300,"linear",function(){c(".msgMode").removeClass("show").addClass("hide");});},1500);}return g;},};var d=new b();var f={pc_error1:"请填写正确的邮政编码！",pc_error2:"请填写正确的11位手机号！",nicknameNull:"昵称不能为空！",nicknameFormatError:"昵称长度不能大于20个字符！",bornDateNull:"请选择出生年月日！",emailNull:"Email不能为空！",emailFormatError:"Email格式错误！",phoneTypeNull:"请选择机型！",qqNull:"QQ号不能为空！",qqFormatError:"QQ号不正确！"};var e=a.namespace("Gnwap");e.version="0.8";a.mix(e,{init:function(){e.checkForm();e.saveForm();},checkInput:function(){var h={nickname:c("input[name=nickname]"),qq:c("input[name=qq]"),email:c("input[name=email]"),phoneType:c("select[name=model]"),byear:c("select[name=year]"),bmonth:c("select[name=month]"),bday:c("select[name=day]")};var g=null;if(h.nickname&&h.nickname.val()==""){return d.message(f.nicknameNull,false);}if(h.qq&&h.qq.val()==""){return d.message(f.qqNull,false);}else{g=/^\d+$/;if(h.qq.get().length&&!g.test(h.qq.val())){return d.message(f.qqFormatError,false);}}if(h.email&&h.email.val()==""){return d.message(f.emailNull,false);}else{g=/^[a-zA-Z0-9_+.-]+\@([a-zA-Z0-9-]+\.)+[a-zA-Z0-9]{2,4}$/;if(h.email.get().length&&!g.test(h.email.val())){return d.message(f.emailFormatError,false);}}if(h.byear&&h.byear.val()=="请选择年"){return d.message(f.bornDateNull,false);}if(h.bmonth&&h.bmonth.val()=="请选择月"){return d.message(f.bornDateNull,false);}if(h.bday&&h.bday.val()=="请选择日"){return d.message(f.bornDateNull,false);}if(h.phoneType&&h.phoneType.val()==0){return d.message(f.phoneTypeNull,false);}return true;},saveForm:function(){c("#J_saveForm").on("submit",function(g){g.preventDefault();if(!e.checkInput()){return false;}var j=c(this),h=j.attr("action");var i=j.serialize()+"&token="+token;j.addClass("required");if(j.hasClass("required")){c.post(h,i,function(k){if(k.success==false){j.removeClass("required");return d.message(k.msg,false);}else{if(d.message(k.msg,true)){if(k.data.type=="redirect"&&k.data.url){setTimeout(function(){window.location.href=k.data.url;},2000);}}}},"json");}});},checkForm:function(){if(!c("#J_checkForm")){return;}var h=c("#J_checkForm").attr("action"),g=c("textarea[name=react]"),i=c("input[name=contact]");c("#J_checkForm").on("submit",function(m){m.preventDefault();var l=c(this),k=/^[a-zA-Z0-9_+.-]+\@([a-zA-Z0-9-]+\.)+[a-zA-Z0-9]{2,4}$/.test(i.val()),j=/^1[3458]\d{9}$/.test(i.val());if(g.val()==""){return d.message("请填写反馈内容！",false);}if(g.val().length>500){return d.message("反馈内容过长！",false);}if(i.val().length>0&&!(k||j)){return d.message("联系方式格式错误！",false);}c.post(h,{react:g.val(),contact:i.val(),token:token},function(n){if(n.success===false){return d.message(n.msg,false);}else{if(d.message(n.msg,true)){if(n.data.type=="redirect"&&n.data.url){setTimeout(function(){location.href=n.data.url;},2000);}}}},"json");});}});c(function(){e.init();var g=c("body").attr("dt-cr");if(g){c("a").click(function(h){h.preventDefault();var i=this.getAttribute("dt-labelCla")?"&tid="+this.getAttribute("dt-labelCla"):"";location.href=g+"?url="+encodeURIComponent(this.href)+i;});}});})(ICAT,Zepto);