(function(a){a.PathConfig();a.app("Game",function(){var b={slidePic:function(){var c=$(".J_slidePic");if(!c[0]){return;}a.include(["./flexslider.js"],function(){c.children(".slideWrap").flexslider({selector:".pic >li",slideshowSpeed:5000,directionNav:false,animation:"slide"});
},true);},screenshot:function(){var d=$("#J_screenshot");if(!d[0]){return;}var c=$(".pic-wrap span");var e=c.size()*c.width()+(c.size()-1)*5;$(".wrap").css({width:e});
return;},openClose:function(){var c=$(".J_openBtnWrap");if(!c[0]){return;}c.find("span").click(function(){this.innerHTML=this.innerHTML=="展开"?"收起":"展开";
c.parent("div").find("[data-text]").toggleClass("h-auto");});},loadMore:function(){var c=$(".J_loadMore[data-ajaxUrl]");if(!c[0]){return;}c.on("click",function(){var e=c.attr("data-hasnext");
if(e==0||e=="false"){return false;}var d=parseInt(c.attr("data-curpage"));c.html('<img src="'+Game.loadingPic+'" />');$.post(c.attr("data-ajaxUrl"),{page:d+1,token:token},function(l){var h=$(".J_gameItem ul, .J_topicItem ul,.J_resultItem ul,.J_classItem ul,.J_evaItem ul,.J_centerItem ul"),k="",j=!!document.querySelector(".J_topicItem"),f=!!document.querySelector(".J_resultItem"),m=!!document.querySelector(".J_classItem"),g=!!document.querySelector(".J_evaItem"),i=!!document.querySelector(".J_centerItem");
if(j){strTemp='<li>										<a href="{link}">											<div class="intro"><span class="pic"><img data-src="{img}" src="'+Game.blankPic+'"></span>											<span class="title"><b>{title}</b><em>{start_time}</em></span></div>											<div class="content"><span class="desc">{resume}</span></div>										</a>									</li>';
}else{if(m){strTemp='<li>										<a href="{link}">											<span class="pic"><img data-src="{img}" src="'+Game.blankPic+'"></span>											<span class="desc"><b>{title}</b><em>{game_title}</em></span>										</a>									</li>';
}else{if(f){strTemp='<li>										<a class="detail" href="{alink}">											<div class="pic"><img  alt="" data-src="{img}" src="'+Game.blankPic+'"></div>											<div class="desc">												<h3>{name}</h3>												<p>{resume}</p>											</div>										</a>										<div class="download"><a class="btn" href="{link}">安装</a></div>									</li>';
}else{if(g){strTemp='<li>										<a class="detail" href="{link}">											<div class="photo"><img  alt="" data-src="{img}" src="'+Game.blankPic+'"></div>											<div class="desc">												<h3>{title}</h3>												<p>													{resume}												</p>											</div>										</a>									</li>';
}else{if(i){strTemp='<li>										<a class="detail" href="{link}">											<div class="photo"><img  alt="" data-src="{img}" src="'+Game.blankPic+'"></div>											<div class="desc">												<h3>{title}</h3>												<p>													{resume}												</p>											</div>										</a>									</li>';
}else{strTemp='<li>										<a class="detail" href="{alink}">											<div class="pic"><img  alt="" data-src="{img}" src="'+Game.blankPic+'"></div>											<div class="desc">												<h3>{name}</h3>												<p>{resume}</p>											</div>										</a>										<div class="download"><a class="btn" href="{link}">安装</a></div>									</li>';
}}}}}tdMerge=function(n,q,o){if(!a.isString(n)||!/\{|\}/g.test(n)){return false;}var p=n.match(/(\{[a-zA-Z]+-[a-zA-Z]+\})|(\{[a-zA-Z]+[a-zA-Z]+\})|(\{[a-zA-Z]+_[a-zA-Z]+\})/g);
if(!p.length){return false;}a.foreach(p,function(){var r=this.replace(/\{|\}/g,""),t=new RegExp("{"+r+"}"),s=q[r];n=n.replace(t,s?s:(o?"{"+r+"}":""));});
return n;};a.foreach(l.data.list,function(o,n){k+=tdMerge(strTemp,n);});h.append(k);if(l.data.hasnext==0||l.data.hasnext=="false"){c.hide();}b.lazyLoad(document.body,100);
c.attr("data-hasnext",l.data.hasnext).attr("data-curpage",l.data.curpage).html("<span>加载更多</span>");},"json");});},backTop:function(){var c=$(".J_gotoTop");
if(!c[0]){return;}window.onscroll=function(){if(document.body.scrollTop>=180){c.css("display","block");}else{c.css("display","none");}};c.find("a").removeAttr("href").on("click",function(d){d.preventDefault();
window.scrollTo(0,0);d.stopPropagation();});},lazyLoad:function(d,c){if(!d){return;}var f=d.querySelectorAll('img[src$="blank.gif"]'),e=function(i){var h=i.getAttribute("data-src");
a.__IMAGE_CACHE=a.__IMAGE_CACHE||{};if(!h){return;}if(!a.__IMAGE_CACHE[h]){var g=new Image();g.src=h;g.onload=function(){i.src=h;a.__IMAGE_CACHE[h]=true;
g=null;};}else{i.src=h;}};a.foreach(f,function(h,g){c?setTimeout(function(){e(g);},h*c):e(g);});},submitForm:function(){var g=$(".J_submitBtn");if(!g[0]){return;
}var f=g.closest("form"),e=f.find("input, textarea"),d=function(j){var i=$(".J_tipBox"),h=$(document).width(),k=i.width();i.find("p").html(j);i.css("left",(h-k)/2+"px").removeClass("invisible");
setTimeout(function(){i.addClass("invisible");i.find("p").html("");},3000);},c=function(){var j={},k=f.attr("data-ajaxUrl")||f.attr("action");for(var l=0,h=e.length;
l<h;l++){if(e.eq(l).attr("rqd")&&e[l].value==""){d(e.eq(l).attr("data-null"));return;}if(e[l].value!=""&&e.eq(l).attr("pattern")){var m=new RegExp(e.eq(l).attr("pattern"));
if(m&&!m.test(e[l].value)){d(e.eq(l).attr("data-error"));return;}}j[e.eq(l).attr("name")]=e[l].value;}if(!g.hasClass("disabled")){g.addClass("disabled");
btime=+new Date();}else{ctime=+new Date();if(ctime-btime>=5000){g.removeClass("disabled");}else{d("请在5秒后提交意见");return;}}$.post(k,j,function(i){var n=typeof i=="string"?JSON.parse(i):i;
d(n.msg);setTimeout(function(){if(n.data.type=="redirect"){location.href=n.data.url;}},3000);});};g.on("click",function(h){h.preventDefault();c();});},search:function(){var c=$(".search-bar .search");
if(!c[0]){return;}var f=c.closest("form"),e=f.find("input, textarea"),d=function(j){var i=$(".J_tipBox"),h=$(document).width(),k=i.width();i.find("p").html(j);
i.css("left",(h-k)/2+"px").removeClass("invisible");setTimeout(function(){i.addClass("invisible");i.find("p").html("");},3000);},g=function(){var j=f.attr("action");
for(var k=0,h=e.length;k<h;k++){if(e.eq(k).attr("rqd")){if(e[k].value==""&&e[k].placeholder==""){e[k].blur();d(e.eq(k).attr("data-null"));}else{if(e[k].value!=""||e[k].placeholder!=""){if(e[k].value==""&&e[k].placeholder!=""){e[k].value=e[k].placeholder;
}f.submit();}}}}};c.on("click",function(h){h.preventDefault();g();});},setDialogBg:function(){if(!$(".J_dialog")[0]){return;}$(".J_dialog").width(document.body.clientWidth).height(document.body.scrollHeight);
},clipBoard:function(){var c=$(".J_clipboard");if(!c[0]){return;}showTip=function(f){var e=$(".J_tipBox"),d=$(document).width(),g=e.width();e.find("p").html(f);
e.css("left",(d-g)/2+"px").removeClass("invisible");setTimeout(function(){e.addClass("invisible");e.find("p").html("");},3000);};a.include(["./clipboard.js"],function(){ZeroClipboard.config({swfPath:a.PathConfig.appRef+"ZeroClipboard.swf"});
c.on("click",function(){var d=new ZeroClipboard();d.on("copy",function(e){e.clipboardData.setData("text/plain",c.children("a").attr("data-href"));showTip("复制成功");
});d.on("complete",function(){});});});},checkUaWhenDownload:function(){if(!$(".J_game_download").length||!$(".J_wechat_browse_tips").length){return;}$(".J_game_download").click(function(d){var c=navigator.userAgent.toLowerCase();
if(/micromessenger/.test(c)){$(".J_wechat_browse_tips").removeClass("hidden");return false;}});$(".J_close_downloadDialog").bind("click",function(){$(".J_wechat_browse_tips").addClass("hidden");
});}};return{version:1.3,blankPic:a.PathConfig.appRef.replace(/assets\/js\//g,"pic/blank.gif"),loadingPic:a.PathConfig.appRef.replace(/assets\/js\//g,"pic/loading.gif"),init:function(){b.setDialogBg();
b.slidePic();b.loadMore();b.screenshot();b.openClose();b.backTop();b.submitForm();b.search();b.lazyLoad(document.body,100);b.clipBoard();b.checkUaWhenDownload();
}};});a.include(["lib/jquery/jquery.js"],function(){Game.init();},true);})(ICAT);