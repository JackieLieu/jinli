(function(a){var d={curIndex:1,hasnext:true};GameApk.template={slidePic:'<section >			<div class="slide-pic ">			<%if(data.length){%>				<div class="slideWrap">					<div class="pic">					<%for(var i=0, len=data.length; i<len; i++){%>						<a <%if(version!="v1"){%> data-type="<%=data[i]["data-type"]%>" <%}%>  data-infpage="<%=data[i]["data-infpage"]%>" >							<img src="<%=blankPic%>" data-special data-src="<%=data[i].img%>">							<div><span><%=data[i].title%></span></div>						</a>						<%}%>					</div>				</div>				<%}%>			</div>		</section>',recItem:'<section>			<div class="channel-list ">			<%if(data.length&&data.length>=4){%>				<ul>				<%for(var i=0, len=data.length; i<len; i++){%>					<%if(i>=4){%>					<%}else{%>						<li>							<a <%if(version!="v1"){%> data-type="<%=data[i]["data-type"]%>" <%}%> data-infpage="<%=data[i]["data-infpage"]%>">								<div class="img-box">									<div class="panel">										<img src="<%=blankPic1%>" data-src="<%=data[i].icon%>" alt="">									</div>								</div>								<div class="layer"><span><%=data[i].title%></span></div>							</a>						</li>					<%}}%>				</ul>			<%}%>			</div>		</section>',activity:'<section >			<%if(data.length!=0){%>			<div class="activity-list ">				<a data-type="-1" data-infpage="<%=data["data-infpage"]%>"><img src="<%=blankPic1%>" data-src="<%=data.img%>" alt="">				<div><span><%=data.title%></span></div>				</a>			</div>			<%}%>		</section>',recommendlist:'<section class="wrap" >			<div class="rec3-list">			<%if(data.list.length){%>				<ul>					<%for(var i=0, len=data.list.length; i<len; i++){%>						<li>						<%if(data.list[i].hot=="最新"){%>							<div class="new"><span><%=data.list[i].hot%></span></div>						<%}else if(data.list[i].hot=="最热"){%>							<div class="hot"><span><%=data.list[i].hot%></span></div>						<%}else if(data.list[i].hot=="首发"){%>							<div class="first"><span><%=data.list[i].hot%></span></div>						<%}else if(data.list[i].hot=="活动"){%>						<div class="event"><span><%=data.list[i].hot%></span></div>						<%}else{%>						<%}%>					<a <%if(version!="v1"){%> data-type="<%=data.list[i]["data-type"]%>"  <%}%> data-infpage="<%=data.list[i]["data-infpage"]%>">						<span class="icon">						<img src="<%=blankPic%>" data-src="<%=data.list[i]["img"]%>" alt="">						</span>						<span class="desc">						<em><%=data.list[i].name%></em>						<p><em><%=data.list[i].category%></em><em>|</em><em><%=data.list[i].size%></em>						<%if(version=="v2"){%>						<%if(data.list[i].attach!=""||data.list[i].device!=0){%>							<em class="tips">							<%var tipArr=data.list[i].attach.split(",");while(tipArr.length){%>								<%if(tipArr[0]=="礼"){%>									<span class="gift"></span>								<%}if(tipArr[0]=="评"){%>									<span class="comment"></span>									<%}tipArr.shift();}%>									<%if(data.list[i].device==1){%>										<span class="grip"></span>									<%}%>							</em>						<%}}%>						</p>						<b><%=data.list[i].resume%></b>						</span>						</a>					</li>					<%}%>				</ul>				<%}%>			</div>		</section>',category:'<section class="wrap">			<div class="category-list">			<%if(data.list.length){%>				<ul>				<%for(var i=0,j=data.list.length;i<j;i++){%>					<li>						<a <%if(version!="v1"){%> data-type="<%=data.list[i]["data-type"]%>" <%}%> data-infpage="<%=data.list[i]["data-infpage"]%>" >							<span class="pic"><img src="<%=blankPic%>" data-src="<%=data.list[i]["img"]%>" alt=""></span>							<span class="desc"><b><%=data.list[i]["title"]%></b><em><%=data.list[i]["game_title"]%></em></span>						</a>					</li>				<%}%>				</ul>			<%}%>			</div>		</section>',subject:'<section class="wrap">			<%if(data.list.length){%>			<div class="subject-list">				<ul>				<%for(var i=0,j=data.list.length;i<j;i++){%>					<li>						<a <%if(version!="v1"){%> data-type="<%=data.list[i]["data-type"]%>" <%}%> data-infpage="<%=data.list[i]["data-infpage"]%>" >							<div class="intro">								<span class="pic"><img src="<%=blankPic%>" data-src="<%=data.list[i]["img"]%>" alt="" ></span>								<span class="title"><b><%=data.list[i]["title"]%></b><em><%=data.list[i]["start_time"]%></em></span>							</div>							<div class="content"><span class="desc"><%=data.list[i]["resume"]%></span></div>						</a>					</li>				<%}%>				</ul>			</div>			<%}%>		</section>'};var b=typeof t_bi!="undefined"?("t_bi="+t_bi):"",c=0;GameApk.view=a.View.extend({tmplData:{blankPic:a.PathConfig.picPath+"blank.gif",blankPic1:a.PathConfig.picPath+"blank1.gif",version:GameApk.ApiVersion}});GameApk.view.setting={slidePic:{config:{tmplId:"slidePic",wrap:".module",ajaxUrl:GameApk.ApiVersion=="v2"?"/api/Kingstone_indexi/turn":"/api/Kingstone_index/turn",}},recItem:{config:{tmplId:"recItem",imgSelector:'img[src$="blank1.gif"]',ajaxUrl:GameApk.ApiVersion=="v2"?"/api/Kingstone_indexi/channel":"/api/Kingstone_index/channel",wrap:".module"}},activity:{config:{tmplId:"activity",imgSelector:'img[src$="blank1.gif"]',ajaxUrl:"/api/Kingstone_indexi/announce",wrap:".module"}},recommend:{config:{tmplId:"recommendlist",wrap:".module",ajaxUrl:GameApk.ApiVersion=="v2"?"/api/Kingstone_indexi/recommend":"/api/Kingstone_index/recommend",clear:false,callback:function(g,e,f){GameApk.view.setting.ajaxSucCallback(g,e,f);},events:[{selector:window,type:"scroll",preventDefault:true,stopPropagation:true,callback:function(f,e){GameApk.view.setting.eventCallback(f,e,this);}}]},},category:{config:{wrap:".module",tmplId:"category",ajaxUrl:"/api/Kingstone_category/index?sp="+GameApk.spParam,clear:false,callback:function(g,e,f){GameApk.view.setting.ajaxSucCallback(g,e,f);},events:[{selector:window,type:"scroll",preventDefault:true,stopPropagation:true,callback:function(f,e){GameApk.view.setting.eventCallback(f,e,this);}}]}},subject:{config:{wrap:".module",tmplId:"subject",ajaxUrl:GameApk.ApiVersion=="v2"?"/api/Kingstone_subject/index?sp="+GameApk.spParam:"/api/Kingstone_subject/index",clear:false,callback:function(g,e,f){GameApk.view.setting.ajaxSucCallback(g,e,f);},events:[{selector:window,type:"scroll",preventDefault:true,stopPropagation:true,callback:function(f,e){GameApk.view.setting.eventCallback(f,e,this);}}]}},ajaxSucCallback:function(h,e,g){if(!g.data||!g.data.list){return;}if(g.data&&g.data.list.length>0){d.hasnext=g.data.hasnext;d.curIndex=g.data.curpage+1;}var f=document.getElementsByClassName("J_loadMore");if(d.hasnext){if(f.length){f[0].style.display="none";}}else{if(f.length){f[0].children[0].className="bottom";f[0].children[0].innerHTML="到底了，去其它页面看看吧";}}},eventCallback:function(h,f,i){if(d.hasnext==true){var j=document.body.clientHeight,e=document.documentElement.clientHeight,k=document.body.scrollTop;if(Math.abs(j-e)<=k+50){if(!$(".module").find(".J_loadMore").length){$(".module").append('<div class="loading J_loadMore"><span class="load"></span></div>');}$(".J_loadMore").show();var g="";if(i.config.ajaxUrl.indexOf("?sp")>-1){if(i.config.ajaxUrl.indexOf("&page")>-1){g=i.config.ajaxUrl.split("&")[0]+"&page="+d.curIndex;}else{g=i.config.ajaxUrl+"&page="+d.curIndex;}}else{g=i.config.ajaxUrl.indexOf("?page")>-1?i.config.ajaxUrl.split("?")[0]+"?page="+d.curIndex:i.config.ajaxUrl+"?page="+d.curIndex;}i.setConfig({ajaxUrl:g,subkey:d.curIndex});}}else{$(window).unbind("scroll");}}};})(ICAT);