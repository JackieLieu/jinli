(function(a,b){a.app("hotapp",function(){return{version:"1.0",blankPic:a.PathConfig.picPath+"blank.gif",};});a.mix(hotapp,{init:function(){hotapp.firstLoad();hotapp.slidePic();hotapp.openclose();hotapp.lazyLoad(document.body,100);hotapp.hover();},slidePic:function(){var c=b(".pic-show .wrap ul li").size()*b(".pic-show .wrap ul li").width();b(".pic-show .wrap ul").css({width:c});return;},lazyLoad:function(d,c){var f=b(d).find('img[src$="blank.gif"]'),e=function(i){var h=i.getAttribute("data-src");a.__IMAGE_CACHE=a.__IMAGE_CACHE||{};if(!h){return;}if(!a.__IMAGE_CACHE[h]){var g=new Image();g.src=h;g.onload=function(){i.src=h;a.__IMAGE_CACHE[h]=true;b(i).attr("data-src",h);g=null;};}else{i.src=h;b(i).attr("data-src",h);}};a.foreach(f,function(h,g){c?setTimeout(function(){e(h);},g*c):e(g);});},openclose:function(){var d=b(".J_expand"),c=b(d.children("p")[0]),e=b(d.children("p")[1]),f=b("#J_content");d.bind("click",function(){if(c.hasClass("hidden")){c.removeClass("hidden");e.addClass("hidden");f.removeClass("h-auto");}else{e.removeClass("hidden");c.addClass("hidden");f.addClass("h-auto");}});},firstLoad:function(){if(!b(".J_loadMore")[0]){return;}var c=function(){b(".J_app_item").show();b(".J_loadMore").show();hotapp.loadMore();};var d=function(){};hotapp.getData(c,d);},loadMore:function(){var d=b(".J_loadMore");if(!d[0]){return;}var g=false,i=d.attr("data-hasnext"),h=b("#J_text_tip"),e=b("#J_img_tip");var c=function(){g=false;var j=b(".J_loadMore").attr("data-hasnext");if(j==0||j=="false"){b(window).unbind("scroll");d.hide();}else{h.hide();e.css("display","inline-block");}};var f=function(){g=false;setTimeout(function(){e.hide();h.css("display","inline-block");},4000);};b(window).scroll(function(k){var l=document.body.clientHeight,j=document.documentElement.clientHeight,m=document.body.scrollTop;if(i==0||i=="false"){b(window).unbind("scroll");}else{if(g==true){return;}if(Math.abs(l-j)<=m+10){h.hide();e.css("display","inline-block");g=true;hotapp.getData(c,f);}}});},getData:function(d,e){var c=b(".J_loadMore"),g=parseInt(c.attr("data-curpage")),f=c.attr("data-ajaxUrl");b.ajax({type:"POST",url:f,data:{page:g+1,token:token},dataType:"json",success:function(l){c.attr("data-hasnext",l.data.hasnext).attr("data-curpage",l.data.curpage);var j=b(".J_app_item"),k="",i='<li>								<a class="info" href="{detailUrl}">									<div class="icon"><img alt=""  src="'+hotapp.blankPic+'" data-src="{icon}"></div>									<div class="desc">										<p class="title">{name}</p>										<p class="size">{size}</p>										<p class="rank-{score}">										<span></span><span></span><span></span><span></span><span></span></p>									</div>								</a>								<div class="download"><a class="btn btn-default" href="{link}">下载</a></div>							  </li>',h=function(m,p,n){if(!a.isString(m)||!/\{|\}/g.test(m)){return false;}var o=m.match(/(\{[a-zA-Z]+-[a-zA-Z]+\})|(\{[a-zA-Z]+[a-zA-Z]+\})|(\{[a-zA-Z]+_[a-zA-Z]+\})/g);if(!o.length){return false;}a.foreach(o,function(){var q=this.replace(/\{|\}/g,""),s=new RegExp("{"+q+"}"),r=p[q];m=m.replace(s,r?r:(n?"{"+q+"}":""));});return m;};a.foreach(l.data.list,function(m,n){k+=h(i,m);});j.append(k);hotapp.lazyLoad(document.body,100);d();},error:function(){e();}});},hover:function(){var c=b(".download a.btn");if(!c.length){return;}c.on("touchstart",function(){b(this).addClass("btnHover");});c.on("touchmove",function(){b(this).addClass("btnHover");});c.on("touchend",function(){b(this).removeClass("btnHover");});}});b(function(){hotapp.init();});})(ICAT,Zepto);